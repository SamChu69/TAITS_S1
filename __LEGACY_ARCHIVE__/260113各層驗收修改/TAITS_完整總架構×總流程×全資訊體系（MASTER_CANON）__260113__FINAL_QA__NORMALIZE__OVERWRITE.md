# TAITS_完整總架構×總流程×全資訊體系（MASTER_CANON）

## 文件頭（Document Header）

- doc_key：MASTER_CANON
- 治理位階：母體／憲法級（完整總架構×總流程×全資訊體系）
- 適用範圍：TAITS 全系統（Canonical Flow L1–L11 全層語義定錨／資料與事件流全景／Agent 與治理邊界／L9-L11 關鍵口徑）
- 版本狀態：ACTIVE（單一正確正文版）
- 版本日期：2026-01-11（Asia/Taipei）
- 基線日期：2026-01-11（Asia/Taipei）
- 強制定錨：Regime／Risk／Compliance 高於策略；L9=投資報告；L10=人類裁決；L11=全層稽核回放（非下單層）
- 治理裁決序位（由高至低）：DOCUMENT_INDEX、MASTER_ARCH、AI_GOV（最終裁決序位）
- 平行參照：FULL_ARCH／ARCH_FLOW／RISK_COMPLIANCE／GOVERNANCE_GATE_SPEC／EXECUTION_CONTROL／UI_SPEC／VERSION_AUDIT／DATA_SOURCES
- 變更原則：最大完備＋累積式更新（允許融合更新／覆寫修正／重排版以形成單一正確正文；禁止摘要化縮水；未被新版本明確取代之有效內容一律保留並持續累積；已被新版本明確取代者可自正文移除但必須由稽核留痕承接）

------

## 全局定錨｜單一口徑

- 本文件為單一正確正文版；任何歷史狀態標記不構成正文裁決依據（以上位裁決序位 DOCUMENT_INDEX、MASTER_ARCH、AI_GOV 與本文件為準）。
- **Regime（市場狀態/情境）高於策略**；Risk/Compliance（風險/合規）可否決一切。
- 策略 ≠ 下單；Agent ≠ 策略；AI ≠ 唯一真理。
- L9＝投資報告層（含數據/圖形/條件式進出場建議〔非指令〕/風險敘述/可追蹤更新欄位）
- L10＝人類裁決與交易決策層（唯一交易授權入口）
- L11＝全層工程稽核回放層（L1–L11 全留痕），且 L11 非下單層

---

## SOVEREIGNTY｜人類最高決策者唯一主權（不可牴觸）

- TAITS 之**唯一最高主權**屬於人類最高決策者（產品負責人／架構裁決者）。
- 任何文件之治理位階、任何治理閘門（Gate）、任何 Agent、任何程序性規則不得凌駕人類主權；不得以程序性理由阻止人類明確命令之生效。
- 風險與合規（Risk/Compliance）之「最高否決權」屬**系統內最高否決**：在**無人類明確命令**時可否決；在**有人類明確命令**時必須輸出完整風險揭露與替代方案，並以「強制揭露＋確認＋全紀錄」承接（不得以程序性理由卡死更新）。

---

## HFI｜人類明確命令（可執行觸發工件）

- HFI（Human-First Instruction）指人類最高決策者對「文件融合更新／語義定錨／工程落地」之明確指令。
- HFI 生效時：允許在 scope 範圍內進行**融合更新／覆寫修正／重排版**以形成單一正確正文；治理閘門不得以程序性理由阻擋更新，但必須以**稽核留痕**承接。
- HFI 不等於下單指令；任何交易授權仍需遵守 L10 語義與 EXECUTION_CONTROL/RISK_COMPLIANCE 之制度約束。

---

## 0. 文件定位（Canonical Master｜最大完備整合版）

本文件為 **TAITS（Taiwan Alpha Intelligence Trading System）之 Canonical Master 文件**，目的在於：

- 定義 TAITS 全系統 Canonical Flow（L1–L11）之唯一正確順序、層級責任與不可越權邊界
- 統一 Evidence（證據）/ Gate（治理閘門）/ Veto（否決）/ Agent（多智能體）之法律地位與交互規則
- 提供全模式一致性（Research／Backtest／Simulation／Paper／Live）之母體可回放定義
- 作為跨文件語義定錨與流程責任分層之 Canonical 母板：若與下位文件衝突，以本文件裁決；但不得牴觸上位裁決序位（DOCUMENT_INDEX、MASTER_ARCH、AI_GOV）。

---

## 【Canonical 使用與解讀指引（Normative Reading Guide）】

### 重要解讀原則（強制）

1. **本文件是「流程與責任分層」的母體，不是策略內容本體**：策略宇宙與因子索引屬候選集合，必須受 Canonical Flow 約束。
2. **策略 ≠ 下單**：任何策略輸出皆不得跳過 L10 的人類裁決與授權。
3. **AI ≠ 決策主體**：AI 僅能作為輔助與建議來源，不得擁有最終裁決權。
4. **Regime 高於策略**：任何策略/建議需先通過市場情境（Regime）與風險約束的可行性檢查。
5. **Risk/Compliance 可否決（在無人類明確命令時）**，在有人類明確命令時必須「揭露＋確認＋全留痕」承接，不得形成混讀或暗中越權。
6. **L11 永遠不是下單入口**：L11 僅負責稽核回放與工程追溯，不得被設計成可觸發交易的控制面。

- 實際分析輸出之深度、形式與篇幅得依市場情境、風險等級與人類決策需求彈性調整，惟不得違反本 Canon 所定義之層級語義與不可越權原則。
- 任何文件、模組、AI 行為或工程實作若與本文件之語義邊界衝突，一律以 MASTER_CANON 為最終裁決依據。

本指引為解讀與使用說明，不構成新增流程、層級或權限之修改。

---

## Taiwan Alpha Intelligence Trading System

---

## Canonical 前言（Why This Canon Exists）

本文件為 **TAITS 的 Canonical Master 文件**。

若《MASTER_ARCH》回答的是：
**「什麼永遠不能被違反？」**

那麼《MASTER_CANON》回答的是：
**「TAITS 是如何被正確地運作？」**

本文件的存在目的不是加速交易，
而是確保 **任何一筆交易的生成，都經過可回放、可審計、可否決的完整過程**。

---

## 第 1 章｜MASTER_CANON 的法律地位與使用規則

### 1.1 文件位階
- 治理位階：**Canonical 主幹（本文件）**
- 位階關係：
  - 受制於：`MASTER_ARCH`
  - 上位於：`ARCH_FLOW`、`FULL_ARCH`、`RISK_COMPLIANCE`、`EXECUTION_CONTROL`

📌 下位文件**不得推翻**本文件定義之 Canonical 順序與責任分層。

---

### 1.2 Canonical 的唯一裁決權
本文件具有以下裁決功能：

- 定義全流程 Canonical 順序（L1–L11）
- 定義每層不可跳步與不可越權條款
- 定義 Evidence 與 Veto 的法律地位
- 定義多模式一致性（Research / Backtest / Simulation / Paper / Live）

---

### 1.3 使用規則（Mandatory）
使用 TAITS 的任何人、任何 Agent、任何模組：

- **必須依 Canonical 順序運作**
- 不得以「效率」為由跳層
- 不得以「策略」為由越權至 Execution
- 不得以「績效」為由弱化 Risk/Compliance

---

## 第 2 章｜TAITS Canonical Flow（L1–L11）

Canonical Flow 是 TAITS 的唯一合法交易生成路徑。

---

### L1｜Data Source（資料取得）
目的：取得官方/授權資料，形成 Raw Data。

輸入：無
輸出：Raw Data
禁止：
- 以非官方裁決制度
- 以單一來源作唯一依據（必須設計 fallback）

---

### L2｜Normalization（資料清洗與標準化）
目的：將 Raw Data 轉為可比較、可回放的 Canonical 格式。

輸入：Raw Data
輸出：Canonical Data
禁止：
- 隱性補值
- 以模型猜測取代缺值（除非明確標記並可追溯）

---

### L3｜Snapshot & State（狀態快照）
目的：建立「當下市場狀態」快照，必須可回放。

輸入：Canonical Data
輸出：Snapshot + State Cache
禁止：
- 只存在記憶體
- 無 version_ref

---

### L4｜Analysis（分析層）
目的：將資料轉為可解釋特徵（Indicators / Factors / Structures）

輸入：Snapshot
輸出：Feature Set
禁止：
- 直接產生交易方向
- 直接輸出下單參數

---

### L5｜Evidence（證據層）
目的：組裝 Evidence Bundle（證據包），形成可審計基礎。

輸入：Feature Set
輸出：Evidence Bundle
禁止：
- 沒 Evidence 進入 Regime/Risk
- Evidence 缺 provenance

---

### L6｜Regime（市場狀態判定）
目的：判定市場狀態（Regime），作為策略啟用前置條件。

輸入：Evidence Bundle
輸出：Regime State
禁止：
- Regime 由單一訊號決定
- Regime 不明確仍往下推進（可 STOP）

---

### L7｜Risk & Compliance（最高否決 Gate）
目的：對所有意圖做 PASS/VETO 裁決。

輸入：Regime State + Evidence + Account/Portfolio + Rules
輸出：PASS / VETO + reason codes + token (PASS only)
禁止：
- 任何形式的 Soft Pass
- 以績效辯護否決

---

### L8｜Strategy & Research（策略與研究層）
目的：提出策略候選（Proposal），並映射到適用條件與約束，形成可治理之 Strategy Proposal（僅提案，非授權、非下單）。

輸入：Risk PASS + Regime State（必備；若未 PASS 或 Regime=UNCERTAIN/STOP，則不得生成提案）
輸出：Strategy Proposal（可回放工件；不得以純敘事替代）

最小輸出工件鍵（Minimum Proposal Artifact Keys｜必備 refs）
- strategy_run_id
- strategy_id / strategy_version
- parameter_set_ref
- evidence_bundle_ref（L5）
- regime_state_ref（L6）
- risk_pass_token_ref（L7，PASS only；僅作引用，不得取代 L11/Execution 之驗證）
- output_proposal_ref（Strategy Proposal 主體引用）
- explanation_bundle_ref（可解釋摘要＋依據 refs）
- hash_manifest_ref（正文指紋）

允許輸出類型（Allowed Proposal Types）
- proposal：enter / exit / reduce / avoid / observe / risk_adjust
- constraints：適用條件、禁入條件、風險上限（不得逾越 L7）
- scenario_notes：說明性備註（Human Understanding Aid；非裁決依據）

禁止：
- 策略直連下單、呼叫任何券商／Broker API／Execution 模組
- 策略覆寫風控條件或推翻 L7 VETO（Risk/Compliance 最高否決權）
- 直接輸出任何可執行委託或等價欄位（包含但不限於：價格、數量、買賣方向、委託型別、帳戶、交易所/通路、立即可送單之指令碼）
- 以績效／勝率／AI 推薦對抗 Regime 或 Risk/Compliance 之否決與限制

---

### L9｜Investment Report（投資報告層｜可追蹤更新、可標的化）

目的：產出「可追蹤、可更新、可標的化」的完整投資報告（Investment Report），作為 L10 人類裁決之主要輸入；同時在報告產出流程中完成必要的「流程治理完整性檢查」（Governance Integrity Check），避免新舊混讀與越權。

輸入：
- Regime State + Evidence Bundle（L6/L5）
- Risk/Compliance 狀態（L7：含否決/限制條件/理由碼）
- Strategy Proposal（L8：候選≠指令）
- Flow Trace / Document Citations（引用最小格式）

輸出（L9 報告工件，必須可追蹤更新）：
- `tracking_id`（唯一鍵）、`report_version`、`as_of`（資料截點）
- 數據（關鍵指標/區間變化/統計摘要，含來源與時間戳）
- 圖形（趨勢/區間/事件標註之可視化或可渲染規格）
- 條件式進出場建議（非指令）：進場/加碼/減碼/出場/停損/停利之「價格區間＋觸發條件」，並附假設、風險點、失效條件
- 風險敘述（含主要風險來源、不可忽略的不確定性、可觀測觸發條件）
- 報告內嵌之治理完整性檢查結果（僅做 RETURN/STOP 的流程阻斷語義，不構成交易批准）

治理完整性檢查（內嵌於 L9，不另設層級）：
- 引用合法性：裁決性引用必須對齊 `DOCUMENT_INDEX`（doc_key / version_date / section_path / why_used）
- 層級邊界：策略 ≠ 下單；AI ≠ 裁決；L11 非批准亦非下單
- 缺口處置：若缺必要文件/引用/審計欄位，則只能 RETURN/STOP，不得以「推測補完」繞過

明確禁止：
- L9 **不是下單層**、**不是批准層**；不得輸出任何可直接轉成下單的指令性內容
- 不得以「報告產出完成」或「已有紀錄」暗示已批准（批准僅能在 L10 由人類裁決）

#### L9 報告工件結構（Report Artifact Schema｜L9_REPORT_ARTIFACT_v1｜最小必帶）

> 說明：本段僅補強「可落地的最小欄位集合與引用鍵」；不改寫 L9 主幹語義（仍為投資報告層、非裁決、非授權、非下單）。

**A. 報告識別（Identity）**
- `tracking_id`：報告唯一追蹤鍵（跨版本不變）
- `report_version`：報告版本（遞增或語義版本）
- `as_of`：本報告資料截點（時間戳）
- `correlation_id` / `session_id`：與本次 Canonical Flow 一致之追蹤鍵

**B. 上游引用（Upstream Refs｜必備）**
- `documents_active_map_ref`：當下生效文件快照（以 DOCUMENT_INDEX 裁決）
- `evidence_bundle_ref`（L5）
- `regime_state_ref`（L6）
- `risk_decision_ref`（L7：PASS/VETO + reason_codes + policy_version）
- `strategy_proposal_ref`（L8：候選≠指令；不得含可執行委託等價欄位）
- `layer_artifacts_map_ref`：各層審計物索引（可回放）

**C. 報告內容（Report Body）**
- `summary`：一頁摘要（人類可讀；禁止暗示已批准）
- `data_block[]`：數據區塊（每項必含 `metric_id`、`value/series`、`unit`、`source_ref`、`timestamp_range`）
- `chart_spec[]`：圖形規格（可視化或可渲染；每項必含 `chart_id`、`data_ref`、`annotation_ref`）
- `thesis`：核心論點（以證據引用支撐；不得用推測補完）
- `assumptions[]`：關鍵假設（每項必含 `assumption_id`、`why_needed`、`break_condition`）
- `invalidations[]`：失效條件（可觀測、可觸發；對位假設）

**D. 方案與條件（Plans｜非指令）**
- `plans[]`：條件式方案集合（每項必含）
  - `plan_id`
  - `plan_type`：enter / add / reduce / exit / avoid / observe / risk_adjust（不得出現 buy/sell/long/short）
  - `price_band`：價格區間（僅為「區間/帶狀」表達；不得形成可下單價格）
  - `trigger_conditions[]`：觸發條件（以可觀測事件/指標定義；不得等價委託條件）
  - `risk_notes`：風險說明（對位 L7 限制與 reason_codes）
  - `expected_horizon`：預期觀察期（僅敘事；非承諾）
- **永久禁止**：任何 `plans[]` 欄位不得含 `qty/size`、`order_type`、`account`、`broker_route`、`execution_instruction`、或可被直接轉譯為委託之等價欄位。

**E. 風險與限制呈現（Risk & Constraints）**
- `risk_summary`：主要風險來源與不確定性
- `constraints_from_risk[]`：由 L7 帶入之限制條件（僅引用，不得改寫）

**F. 可回放與稽核（Replay & Audit）**
- `explanation_bundle_ref`：可解釋依據引用包
- `hash_manifest_ref`：正文指紋（可重算）
- `ui_trace_ref_pre_human`：供 UI_SPEC 對位之呈現證據（可回放）

---

#### L9 內嵌治理完整性檢查輸出（L9 Integrity Check Schema｜L9_INTEGRITY_CHECK_v1）

> 定位：L9 內部自檢（Self-Check）；**不構成主 Gate 裁決**，亦不得被解讀為交易批准。  
> 與主 Gate 的關係：主 Gate 可引用此自檢結果作為「補齊清單與證據引用」，但主 Gate 仍為唯一裁決者（PASS/BLOCK/RETURN）。

**A. 狀態（Status｜僅三態）**
- `integrity_status`：OK / RETURN / STOP  
  - OK：自檢通過（不代表 Gate 通過）  
  - RETURN：可補齊缺口（需列出 return_required_items）  
  - STOP：不可補或矛盾/污染/越權（主 Gate 不得 PASS；預設趨向 BLOCK）

**B. 回補清單（Return Required Items｜若 RETURN 必填）**
- `return_required_items[]`：每項至少包含  
  - `item_id`：缺口識別  
  - `required_for`：對位之層級/章節（例如 L5 Evidence / L6 Regime / L7 Risk / L8 Proposal / 引用合法性）  
  - `description`：需要補齊之內容描述  
  - `rule_ref`：對位之制度引用（doc_key / section_path）  
  - `evidence_ref_optional`：若已存在部分證據，提供引用

**C. 違規與衝突（Violations & Conflicts）**
- `violations[]`：越權/跳步/暗示批准/可下單等價欄位/引用非法 等（附 `code`、`description`、`ref`）
- `conflicts[]`：硬衝突/軟衝突（附 `type`、`between_refs[]`、`impact`）

**D. 產出引用（Refs）**
- `integrity_check_ref`：本自檢工件引用鍵
- `generated_at`：產出時間戳

### L9a｜Analyst Narrative & Investment Rationale
（分析師人話整合報告層）

#### 定位說明
L9a 為 **分析師敘事層（Human-Readable Investment Narrative）**，
其存在目的不是流程裁決，而是對人類輸出可理解、可查證的投資分析敘事。

**L9a 僅能在 L9（投資報告產出流程）中啟動，
不具流程裁決權，亦不具任何交易授權能力。**

L9a 的核心問題是：

**「為什麼這個標的值得被人類進一步考慮？」**

---

#### 核心職責（必須具備）
L9a 輸出的分析報告，必須以白話方式完整說明：

1. **前因事由**
   - 為何該標的進入觀察或分析名單
   - 觸發來源為何（消息 / 基本 / 技術 / 籌碼 / 策略）

2. **現況判斷**
   - 目前市場與個股所處 Regime
   - 現行價位是否合理，是否偏離結構或歷史區間

3. **投資假設**
   - 若進場，核心邏輯與成立條件為何
   - 假設成立時可能對應的時間尺度（短線 / 波段 / 長期）

4. **風險與不確定性**
   - 主要風險來源
   - 哪些情境發生時，原分析將失效或需重新評估

5. **可能的行動方向（非指令）**
   - 僅描述偏向觀察、偏向短線或偏向長期之分析傾向
   - 不構成任何交易指令、價格、數量或批准

---

#### Evidence 要求
- L9a 中所有關鍵敘述，**必須可回指至 L4–L8 所產生之 Evidence**
- 必須能被人類查證、質疑與反駁

---

#### 明確禁止
- L9a **不是下單層**
- L9a **不自動形成交易決策**
- L9a 的任何敘事，**僅作為 L10 人類決策之參考依據**

---

### L10｜Human Decision Authority
（人類最終裁決層）

#### 定位說明
L10 為 TAITS **唯一且不可取代的人類決策層**。

所有交易相關行為，必須由人類在 L10 明確裁決後，
系統方可進入任何執行或模擬流程。

---

#### 人類可做的裁決
- 不進行任何行動
- 進行回測
- 進行模擬交易
- 進行半自動交易
- 進行全自動交易（需明確授權）

📌 **未經 L10 明確裁決，流程不得進入任何執行狀態。**

---


### L10 輸入（Inputs｜入場條件與必備引用）

> 本節為 **L10 的最低可機器化入場契約**。缺任一要件，UI 必須鎖定 APPROVE；流程不得進入任何執行或模擬狀態。

**必備入場條件（Hard Preconditions）**
1. `risk_pass_token_ref` 必須存在且驗證為 PASS only（來源：L7 Risk/Compliance）。  
2. `governance_gate_decision_ref` 必須為 PASS（來源：非層 Governance Gate）。若為 RETURN，必須回到上游補齊缺口，不得進入 L10 授權。  
3. `regime_state_ref` 必須為可推進（不得為 UNCERTAIN/STOP）。  
4. `documents_active_map_ref` 必須存在（鎖定本次裁決所依據之 ACTIVE 文件集合）。

**必備上游引用（Required Refs）**
- `l9_report_ref`（L9 投資報告工件引用；含 tracking_id/report_version/as_of）  
- `evidence_bundle_ref`（L5 Evidence）  
- `regime_state_ref`（L6 Regime）  
- `risk_decision_ref`（L7：PASS/VETO + reason_codes + policy_version；L10 僅承接/呈現，不改寫）  
- `risk_pass_token_ref`（L7 PASS only；僅作引用憑證）  
- `strategy_proposal_ref`（L8：候選≠指令；不得含可執行委託等價欄位）  
- `governance_gate_decision_ref`（非層 Gate：PASS/RETURN + return_required_items）  
- `documents_active_map_ref`（當下生效治理文件快照；以 DOCUMENT_INDEX 裁決）  
- `layer_artifacts_map_ref`（各層審計物索引；可回放）


---

### L10 輸出（Outputs｜Human Decision Record v1）

> 本節為 **L10 的最低可機器化輸出契約**。  
> L10 之輸出分為：  
> (A) 人類裁決紀錄（HumanDecisionRecord）與不可否認簽章；  
> (B) 可被執行層驗證之授權包絡（Authorization Envelope），用以限制任何後續執行行為。

#### (A) 人類裁決紀錄（HumanDecisionRecord_v1｜必備）
- `human_decision_id`：唯一鍵（UUID/ULID）  
- `human_decision`：`APPROVE` / `REJECT` / `ABORT`  
- `decision_target_mode`：`NO_ACTION` / `BACKTEST` / `SIMULATION` / `PAPER` / `LIVE`  
- `automation_level`：`NONE` / `SEMI_AUTO` / `FULL_AUTO`  
  - 當 `decision_target_mode` ∈ {BACKTEST, SIMULATION} 時，`automation_level` 必須為 `NONE`  
  - 當 `decision_target_mode` ∈ {PAPER, LIVE} 時，`automation_level` 允許為 `NONE/SEMI_AUTO/FULL_AUTO`（需人類明確授權）
- `user_id`：裁決者識別（不可空）  
- `decided_at`：時間戳（ISO-8601）  
- `ui_trace_ref`：完整互動軌跡引用（可回放）  
- `decision_reason_ref`：裁決理由引用（可選；不得取代 L7 reason_codes）  
- `upstream_refs`：必須包含本節 Inputs 之 Required Refs（不得缺漏）  
- `hash_manifest_ref`：正文指紋引用（用於回放一致性）

#### (B) 不可否認簽章（Decision Signature｜必備）
- `decision_signature`：不可否認簽章（至少包含 user_id + decided_at + payload_hash）  
- **Canonical 欄位對齊：**
  - `decision_signature`（UI/L10）為語義主鍵；  
  - 執行層輸入使用 `human_approve_signature`，其內容必須與 `decision_signature` **完全相同**（位元級一致）。

> ✅ 以上對齊用於解決跨文件欄位命名不一致：UI/L10（decision_signature）↔ Execution（human_approve_signature）。  
> 任何不一致視為 **Preflight FAIL**，必須 BLOCK + AUDIT。


---

### L10 授權包絡（AuthorizationEnvelope_v1｜必備，對接 Execution Control）

> 授權包絡用於約束執行層可做的事；其存在不代表一定會送單。  
> 執行層不得超出授權包絡；任一超出必須 BLOCK + AUDIT。

- `authorization_envelope_id`：唯一鍵  
- `linked_human_decision_id`：對應 `human_decision_id`  
- `mode`：`BACKTEST` / `SIMULATION` / `PAPER` / `LIVE`（對接 EXECUTION_CONTROL 之 mode）  
- `allowed_actions[]`：允許行為集合（例如：enter/add/reduce/exit/risk_adjust/observe；不得含券商指令語彙）  
- `constraints`（至少包含）：
  - `max_notional`（最大名目額）  
  - `max_orders`（最大委託數）  
  - `max_position_delta`（最大部位變動）  
  - `slippage_guard`（滑價保護）  
  - `time_window`（授權有效時間窗）  
- `risk_pass_token`：對應 L7 的 PASS token（執行層需驗證）  
- `human_approve_signature`：必須等同 `decision_signature`（執行層需驗證）  
- `trace_id`：全程追蹤 ID（跨模組一致）

> 📌 L10 僅輸出授權包絡與裁決紀錄；`order_intent` 與委託細節屬執行層（EXECUTION_CONTROL）範圍，且必須接受授權包絡約束並通過 Preflight。


---

### L10 與 Gate / Risk / Execution 的硬切割（不可混讀）

1. **L10 ≠ Governance Gate**：  
   - Gate 負責 PASS/RETURN/BLOCK 之流程裁決；L10 不得以「自檢通過」取代 Gate 結果。  
2. **L10 ≠ Risk/Compliance**：  
   - L10 不得改寫 L7 的 VETO 或限制條件；只可承接與呈現。  
3. **L10 ≠ Execution**：  
   - L10 不送單、不輸出可執行委託；僅輸出授權包絡（authorization_envelope）與簽章，供 EXECUTION_CONTROL 在 Preflight 驗證後使用。


### L11｜Audit, Replay & System Maintenance
（全層稽核回放與系統維運層｜Non-Execution Layer）

#### 定位說明
L11 為 **純系統層（Machine-Oriented Layer）**，其唯一目的為：
1) 將 L1–L10（含非 Layer 模組）之關鍵工件 **留痕、封存、組裝回放包（Replay Bundle）**；
2) 依版本與雜湊（Hash）規則進行 **可重現驗證（Replay Verification）**；
3) 在偵測污染/缺件/版本漂移時，形成 **完整性事件（Integrity Incident）** 以供稽核與追責。

> 本層不包含、也不得被設計成任何「交易執行（下單/改單/撤單）」入口。  
> 交易執行屬 **非 Layer 模組：doc_key=EXECUTION_CONTROL（Execution Control）**，僅能在 **L10 人類授權** 後運作；其輸出事件流/狀態快照必須被 L11 納入 Replay Bundle 引用收錄。

L11 **不是分析層、不是人話報告層，也不是決策層**；亦 **非授權層、非下單層**。

---

#### 核心職責（Hard Responsibilities）
- **Immutable Artifacts**：將關鍵工件以不可變形式落帳（含版本與雜湊指紋），並能被回放重建。
- **Replay Bundle Assembly**：組裝 ReplayBundle_v1（以「引用鍵」為主，不以敘事替代）。
- **Replay Verification**：依 HASH_RULE 驗證「同一組 bundle → 同一結論」；任何不一致視為污染。
- **Integrity Incident**：對缺件/雜湊不一致/版本漂移/追溯斷鏈建立事件（reason_codes + refs + hash）。
- **Maintenance Evidence**：僅記錄「系統維運」相關狀態（例如資源、延遲、錯誤、Kill Switch 狀態），不得引入交易批准語義。

📌 **無紀錄者，制度上視為未發生，不具任何決策或執行效力。**

---

#### L11 最小輸入契約（L11_MIN_INPUT_REFS_v1｜必備）
> 形式：皆為 `*_ref`（引用鍵）。缺任一項不得宣告回放有效。

- `documents_active_map_ref`：本次執行所依據之 ACTIVE 文件快照（doc_key=DOCUMENT_INDEX 對位）
- `layer_artifacts_map_ref`：L1–L10 主要工件索引（refs map；含 evidence/regime/risk/report/decision）
- `hash_manifest_ref`：所有關鍵工件與事件流之雜湊指紋清單（含 BODY_SHA256 對位）
- `ui_trace_ref`：人機互動留痕（若有 L10）
- `human_decision_record_ref`：HumanDecisionRecord_v1（若有 L10）
- `execution_control_log_ref`：Execution Control 事件流/狀態快照（若有 execution；doc_key=EXECUTION_CONTROL）
- `runtime_env_ref`：運算環境與配置快照（doc_key=LOCAL_ENV / DEPLOY_OPS 之引用）

---

#### L11 最小輸出契約（ReplayBundle_v1｜必備）
> L11 必須產出可回放包（ReplayBundle_v1）。其內容以「引用鍵集合」呈現，並可被 VERSION_AUDIT 驗證。

- `replay_bundle_id`
- `as_of`（資料截點/回放截點）
- `documents_active_map_ref`
- `evidence_bundle_ref`
- `regime_state_ref`
- `risk_decision_ref`
- `strategy_proposal_ref`（若有）
- `l9_report_ref`（若有）
- `governance_gate_report_ref`（若有）
- `human_decision_record_ref`（若有）
- `execution_control_log_ref`（若有）
- `hash_manifest_ref`
- `verification_result`：PASS / FAIL
- `integrity_incident_ref`（若 FAIL）

---

#### 回放驗證規則（Replay Verification｜錨定）
- 規則與事件化處置以 **doc_key=VERSION_AUDIT** 為准；欄位最小集合與回放包最小集合以 **doc_key=ARCH_FLOW** 為准。
- 驗證必須至少涵蓋：
  - `version_ref` 一致性（ACTIVE 文件快照、策略版本、政策版本、執行模組版本）
  - `hash_manifest_ref` 與各工件之 `input_hash/output_hash` 對位一致
  - 追溯鏈（trace）不得斷裂：由 `layer_artifacts_map_ref` 可定位到所有必備工件

---

#### 完整性事件（Integrity Incident｜reason_codes 建議集合）
- `SYS-MISSING-ARTIFACT`：必備工件缺失
- `SYS-HASH-MISMATCH`：雜湊不一致或不可重現
- `SYS-VERSION-DIVERGENCE`：版本漂移（同一回放包出現多版本混讀）
- `SYS-TRACE-GAP`：追溯斷鏈（refs map 無法定位工件）

---

### Canonical Boundary Declaration（最終聲明｜L11 對齊版）

- **風險/合規裁決只存在於 L7**（VETO 最高否決權；不得被 L11 取代或覆寫）
- **策略提案只存在於 L8**（候選≠指令）
- **投資報告只存在於 L9**（報告≠批准）
- **人類裁決與授權只存在於 L10**（唯一授權入口）
- **稽核、回放、完整性驗證與系統維運留痕只存在於 L11**（非授權／非下單入口）
- **交易執行（下單/改單/撤單）屬非 Layer 模組：EXECUTION_CONTROL**（僅能在 L10 授權後運作；其產物由 L11 收錄）

任何層級越權（包含將 L11 誤用為批准/下單/旁路執行入口），皆視為違反 MASTER_CANON 架構母法。
---
## 第 3 章｜Canonical Flow 的不可破壞公理（5 Axioms）

1. **Forward-only**：流程只能前進或中止，不得偷偷回寫修正。
2. **Layer Isolation**：每層只做該層責任，不得越權。
3. **Evidence First**：沒有 Evidence 不得判斷/不得放行。
4. **Veto > Proposal**：否決優先於建議。
5. **Human不可被取代**：L10 必須由人類完成。

---

## 第 4 章｜多模式一致性（Research / Backtest / Simulation / Paper / Live）

### 4.1 不變項（Invariant）
- L1–L11 順序不可變
- Risk/Compliance Gate 不可降級
- Human-in-the-loop 不可移除
- Audit/Replay 不可降低密度

### 4.2 可變項（Only 3）
- 資料來源（歷史/即時）
- 時間推進（模擬/真實）
- Execution 開關（真實/模擬）

---

## 第 5 章｜Evidence 的法律地位

### 5.1 Evidence ≠ 指標
Evidence 是可審計、可追溯、可回放的證據組合。

### 5.2 Evidence 的必備屬性
- provenance（來源鏈）
- completeness（完整性）
- immutability（不可變）
- replayability（可回放）

---

## 第 6 章｜Veto 的法律地位（最高否決權）

### 6.1 Veto 不可被覆寫
- 任何 VETO：流程必須停止或退回
- Human 不得覆寫 Risk/Compliance 的 VETO（不得為例外）

### 6.2 Veto 必須具 reason codes
禁止以「注意」「建議」取代否決理由。

---

## 第 7 章｜Canonical 與策略宇宙的關係

### 7.1 策略只是候選，不是指令
策略輸出只能是 Proposal。

### 7.2 策略不可跳過 Canonical
任何策略若試圖跳過 L1–L11，視為違規。

---

## 第 8 章｜AI 在 Canonical 中的角色（非主體）

### 8.1 AI 的合法位置
AI 可出現在：
- L4（特徵/分析輔助）
- L5（證據組裝輔助）
- L6（Regime 判讀輔助）
- L8（策略候選生成輔助）
- L10（解釋與可視化輔助）

### 8.2 AI 的禁止位置
AI 不得：
- 代替 L10 裁決
- 直達 L11 下單
- 覆寫否決

---

## 第 9 章｜Audit / Replay 的母體規則

### 9.1 無紀錄 = 未發生
任何層級若無審計物，制度上視為未發生。

### 9.2 Replay 必須可重建
相同 Replay Bundle 必須可重建相同結論；否則視為污染。

---

## 第 10 章｜版本一致性與 最大完備＋累積式更新 演進

### 10.1 最大完備＋累積式更新
- 允許為形成「單一正確正文」而進行融合更新／覆寫修正／重排版。
- 禁止摘要化縮水或刪除有效資訊；未被新版本明確更新之有效內容一律保留並持續累積。
- 若舊資訊已被新版本明確取代：可自正文移除，但必須以 `VERSION_AUDIT` 與本檔末端稽核留痕承接（含被取代段落定位與原因）。
- 新版本不得破壞舊 Replay 的可驗證性（可讀、可回放、可對帳）。

### 10.2 舊回放必須可讀
新版本不得破壞舊 Replay 可驗證性。

---

## 第 11 章｜下位文件一致性要求（Mapping）

### 11.1 Canonical 條款與文件責任對位
| Canonical 條款 | 下位文件 |
|---|---|
| L1-L2 Data | DATA_SOURCES / LOCAL_ENV |
| L3 Snapshot | ARCH_FLOW / VERSION_AUDIT |
| L4 Analysis | STRATEGY_FEATURE_INDEX |
| L5 Evidence | ARCH_FLOW / VERSION_AUDIT |
| L6 Regime | STRATEGY_UNIVERSE / ARCH_FLOW |
| L7 Veto | RISK_COMPLIANCE / TWSE_RULES |
| L8 Proposal | STRATEGY_UNIVERSE |
| L9 Gate | DOCUMENT_INDEX / UI_SPEC |
| L10 Human | UI_SPEC / EXECUTION_CONTROL |
| L11 Execution | EXECUTION_CONTROL |

📌 下位文件若與本表不一致，**以本表為準**。

---

### 12.2 下位文件的最低責任
每一份下位文件，**至少**必須回答：
1. 我實作了哪一條 Canonical 條款？
2. 我在哪個流程層級生效？
3. 我的審計輸出是什麼？

---

而是為了讓系統**永遠保持可問責**。

在 TAITS 中：

- 快速但不可審計：**不可接受**
- 聰明但不可否決：**不可接受**
- 有績效但違反流程：**不可接受**

**只有當一套系統，
能在誘惑、壓力與績效面前，
仍然選擇遵守流程與責任，
它才配被稱為「Canonical」。**

---

---

## 13. 文件宇宙的最終分類（Document Ontology｜為 DOCUMENT_INDEX 鋪路）

TAITS 的所有文件，**必須被歸入以下四類之一**。
此分類是「引用合法性」與「衝突裁決」的根基，並將被 `DOCUMENT_INDEX` 作為 Index 裁決與審計輸出的核心欄位。

### 13.1 Normative（規範性文件｜具約束力）
定義：直接產生「必須 / 禁止 / 否決 / 裁決」制度效果。任何實作若與之衝突，視為違規。
典型範圍：MASTER_ARCH、MASTER_CANON、RISK_COMPLIANCE、EXECUTION_CONTROL、VERSION_AUDIT（含其明確裁決條文）。

### 13.2 Procedural（程序性文件｜操作與落地程序）
定義：規範「怎麼做」的程序與作業標準，但不得推翻 Normative 的鐵律與否決權。
典型範圍：DEPLOY_OPS、LOCAL_ENV、BEGINNER_GUIDE（新手教學）等。

### 13.3 Descriptive（描述性文件｜系統說明與架構地圖）
定義：描述系統如何組成、如何流動、如何呈現；不直接裁決「可/不可」，但必須與 Normative 一致。
典型範圍：FULL_ARCH、ARCH_FLOW（其流程規範屬 Canon 之落地，仍具規範性但主要呈現方式為描述+規格）、UI_SPEC（介面規格承載規範義務）。

### 13.4 Reference（參考性文件｜外部制度/資料入口/備忘）
定義：提供來源、條文入口、外部規則彙整或查詢指引；本身不構成 TAITS 內部裁決，但可作為 Evidence/Compliance 來源引用。
典型範圍：TWSE_RULES（含官方入口）、資料來源官方 API 入口與第三方資料補充等。

---

## 14. 引用合法性（Citation Legality｜新會話與實作的共同硬門檻）

### 14.1 Index 先決（Index-First）
- **任何裁決性輸出（含 PASS/VETO/RETURN/STOP）必須引用 DOCUMENT_INDEX 中 ACTIVE 的 doc_key。**
- 引用未入 Index 或非 ACTIVE 文件：視為 `GOV-DOC-01` 類違規。

### 14.2 引用最小格式（Minimum Citation Format）
任何裁決性輸出至少包含：
- `doc_key`
- `version_date`
- `section_path`（至少到章節）
- `why_used`（用於裁決什麼）

缺任一項：不得做裁決性輸出，只能做描述或列出缺口。

### 14.3 官方來源優先（Official-First for Rules）
涉及制度/交易規則/合規裁決時：
- **官方入口為最終裁決來源**（TWSE/TAIFEX/FSC/SFB/TDCC 等）
- 第三方僅可作補充與提示，不得作最終裁決依據

---

## 15. 衝突裁決秩序（Conflict Resolution Order｜母體級裁決）

當文件、模組或 Agent 之間產生衝突時：

- **最終裁決序位固定（由高至低）**：DOCUMENT_INDEX → MASTER_ARCH → AI_GOV。  
- 下列清單為**衝突定位/排查之參照優先順序**（不得構成新的最終裁決序位；不得推翻前述三元裁決），用於在不違反上位裁決的前提下，快速定位衝突來源與責任邊界。

參照優先順序如下（由高至低）：

1) DOCUMENT_INDEX（Authoritative Index 與 ACTIVE 裁決入口）
2) MASTER_ARCH（母體總憲法與核心鐵律）
3) AI_GOV（AI 行為與決策治理最終規則）
4) MASTER_CANON（本文件：Canonical Flow（L1–L11）之唯一正文來源與責任分層定錨）
5) RISK_COMPLIANCE（風險與合規最高否決權）
6) EXECUTION_CONTROL（交易執行與控制硬門檻）
7) VERSION_AUDIT（版本控管、稽核與可追溯治理）
8) ARCH_FLOW（系統架構與流程細化說明）
9) FULL_ARCH（全系統架構總覽）
10) 其他文件（UI_SPEC、DEPLOY_OPS、LOCAL_ENV、DATA_SOURCES、STRATEGY_*、TWSE_RULES、README 等）依 DOCUMENT_INDEX 所列治理位階與文件性質裁決

任何「低位階文件」不得推翻「高位階文件」的語義或否決權。

---

## 16. Canonical Flow（L1–L11）與權限邊界的母法對位（母體級）

本節為 MASTER_CANON 的最終對位：確保「策略 ≠ 決策 ≠ 下單」在制度上不可被偷換。

### 16.1 L1–L11 不可跳步（Non-Skippable）
- L1–L11 之順序不可跳步（ARCH_FLOW 定義細節）
- 任何模式（Research/Backtest/Sim/Paper/Live）不得以方便為由跳層

### 16.2 三權分立（Decision Separation）
- **策略（Strategy）**：只產生「條件與情境」，不得直連下單（L8）
- **裁決（Decision）**：必須由 Human-in-the-loop 完成（L10）
- **執行（Execution）**：僅能在 **L10（人類裁決與交易決策層）** 明確授權之後，並通過 **RISK_COMPLIANCE**（否決裁決）與 **EXECUTION_CONTROL**（執行硬門檻）後，方可進入外部下單／執行；其全程留痕與回放由 **L11（全層工程稽核回放層）** 承接（稽核回放，非授權／非下單入口）

---

## 17. 新會話 / 新 AI 的啟動行為規範（Canonical Onboarding & Guardrails）

### 17.1 啟動目的（Purpose）
新會話 / 新 AI 的啟動，不是為了快速結論或快速交易，而是確保：
1) 不走偏（No Drift）
2) 不越權（No Overreach）
3) 可追責（Accountable）
4) 一致性（Consistency）

### 17.2 啟動必經程序（Mandatory Boot Procedure）
若未完成 Boot Procedure，任何「建議/結論/策略候選」輸出均視為不合規。

#### Boot Step 0｜身份與邊界宣告（必做）
必須宣告：
- 系統身份：TAITS（台灣市場、Regime 優先、Risk/Compliance 最高否決）
- 權限邊界：策略 ≠ 下單；AI ≠ 裁決；Risk 可否決一切
- 文件主權：所有裁決以 DOCUMENT_INDEX + 上位母法為準

#### Boot Step 1｜Canon Set 裝載確認（必做）
必須建立 Documents Active Map，最少包含：
- AI 母法（doc_key=AI_GOV）
- MASTER_CANON
- MASTER_ARCH
- DOCUMENT_INDEX
- RISK_COMPLIANCE
- EXECUTION_CONTROL
- VERSION_AUDIT
- ARCH_FLOW
- FULL_ARCH
- UI_SPEC（Normative 義務）

若缺任一項：
- 必須標示：`Missing Canon: <doc_key>`
- 並限制輸出範圍（不可自行補洞）

#### Boot Step 2｜模式宣告（必做）
必須宣告 Mode（Research/Backtest/Simulation/Paper/Live），並承諾不改變 L1–L11、公理、否決權與 Human-in-the-loop。

#### Boot Step 3｜引用規範啟動（必做）
一旦做裁決性輸出，必須附帶：
- doc_key / version_date / section_path / why_used
否則只能描述或列缺口。

---

## 18. 新會話輸出類型的合法分級（Output Legality Tiers）

### 18.1 Tier-0｜描述（Descriptive Output）
允許：轉述、梳理、建立地圖、指出缺口。
禁止：產生交易方向、形成執行意圖。

### 18.2 Tier-1｜候選建議（Proposal Candidates）
允許：策略候選（僅 L8 語義）、Regime 範圍（含不確定性）、風險映射（可能觸發條款）。
硬限制：必須標示適用/禁用條件；必須聲明未經 L10 不可執行；必須可追溯 Evidence。

### 18.3 Tier-2｜流程裁決（Flow Decision for System Only）
允許：RETURN/STOP 判定（依 ARCH_FLOW），缺審計/缺版本引用阻斷（依 VERSION_AUDIT）。
禁止：裁決是否應交易。

### 18.4 Tier-3｜執行相關輸出（Execution-Adjacent）
裁決：新會話不得輸出任何可被直接轉成下單的內容（價格/數量/時間等作為建議、立即買賣指令、暗示已批准等）。
若使用者要求：必須導向 UI_SPEC 與 EXECUTION_CONTROL 的 Human-in-the-loop 流程，並要求完成 L7/L10/L11 前置條件。

---

## 19. 新會話常見偏移模式（Drift Patterns）與硬阻斷

### 19.1 文件偏移（Doc Drift）
- 引用未入 Index 或非 ACTIVE
- 以「我記得」替代引用
處置：STOP（GOV-DOC-01 / GOV-FLOW-01），要求補齊 Index 或改為描述性輸出。

### 19.2 邊界偏移（Boundary Drift）
- 策略輸出變決策（例如「所以就買」）
- AI 自己批准
- 風控否決被弱化成提醒
處置：STOP（RISK / GOV），UI 必須標示違規建議（UI_SPEC）。

### 19.3 模式偏移（Mode Drift）
- Research 省略風控語義
- Backtest 跳過審計
- Simulation 改寫流程順序
處置：STOP + Audit 記錄（VERSION_AUDIT）；「模式不同」辯護無效。

---

## 20. 新會話的最小證據法則（Minimum Evidence Law）

新會話若要提出 Tier-1（候選建議），必須具備最小 Evidence Bundle：
- snapshot_ref（L3）
- feature_set_ref（L4）
- evidence_provenance_ref（L5）
- regime_state_ref（L6）
- risk_gate_status_ref（L7：至少能說明尚未放行或已放行）

缺任一項：只能 Tier-0 或 Tier-2，禁止候選策略輸出。

---

## 21. 新會話的提問規範（When Must Ask for Instruction）

### 21.1 必須請示（Hard Ask Conditions）
- 文件缺失或版本不明
- 需要新增 doc_key 或新增文件類型
- 需要新增策略白名單或策略分類
- 需要新增風控門檻政策（policy profile）
- 需要修改衝突裁決順序或治理位階

### 21.2 可自治（Allowed Autonomy）
- 文字更清晰（不改義）
- 增加章節、補齊 checklist、補齊 reason codes（最大完備＋累積式更新）
- 補充官方網址入口（Reference 擴充）
- 補充審計欄位（不刪舊）

---

## 22. 新會話審計輸出最小格式（Session Audit Stub）

新會話每次產出 Tier-1 或 Tier-2 內容，必須附帶最小審計 stub（供 UI/Log 捕捉）：
- conversation_id（或等價）
- timestamp_utc
- mode
- output_tier
- docs_active_map_ref
- citations[]（doc_key@version_date#section_path）
- missing_items[]（若有）
- reason_codes[]（若含阻斷/否決/退回）

---

## 23. 新會話與 DOCUMENT_INDEX 的對接規則（Index Coupling Rules）

DOCUMENT_INDEX 必須做到：
1) 新會話能快速得知 ACTIVE 文件與治理位階
2) 新會話能判斷允許引用哪些文件來做裁決，以及衝突裁決順序
3) 新會話能快速生成 citations[]（doc_key@version_date#section_path）

---

## 24. 最大完備＋累積式更新 演進規則（本整合版新增章節專屬）

允許新增：
- 新的 Output Tier（不得弱化既有禁止）
- 新的 Drift Pattern 與 reason_code
- 更嚴格的 Boot Procedure（不可放寬）
- 更完整的 Conversation Audit Stub 欄位

禁止：
- 刪除 Boot Procedure 任一步
### 禁止 AI 自行批准與禁止越權到 L11（單一正確正文）

1) **AI/Agent 不具批准權（No Self-Approval）**
   - AI/Agent/LLM 的輸出一律屬於「輔助建議／整理／檢核／風險提示」性質，**不得**形成任何等同於 *PASS/APPROVE/放行執行* 的裁決語義。
   - 任何「放行、批准、授權進入交易模式」一律屬於 **L10（人類裁決與交易決策層）** 的權限範圍。

2) **L11 非批准層、非下單層（L11 is Audit-only）**
   - **L11（全層工程稽核回放層）**的唯一職能是：對 L1–L11 全鏈路輸入/處理/輸出/裁決/執行進行留痕、可查、可回放。
   - **L11 不具批准權**、**不得被視為批准依據**，且 **L11 非下單層**，不得作為任何形式的下單入口或替代授權層。

#### 禁止事項（Hard Prohibition）
以下任一情形均視為「越權／混層／違規」，必須立即阻止並留痕：
- 以 AI 輸出（包含信心分數、勝率、推薦）**取代** L10 的人類裁決。
- 將 L11 的「已有紀錄／已生成回放」**等同**於「已批准／可執行」。
- 以「稽核／回放」名義輸出任何具**立即執行或下單指令**語義的內容（例如可直接送單的參數集合、券商 API payload）。
- 任何繞過 Risk/Compliance 否決鏈、執行控制（Execution Control）、或跳過治理閘門（Gate）的行為。

#### 正確流程承接（避免誤用）
- **L9**：投資報告層（含數據/圖形/條件式建議/風險/追蹤欄位），但不下單。
- **L10**：人類裁決與交易決策層（唯一授權層）。
- **L11**：全層工程稽核回放層（只留痕與回放，**不批准、不下單**）。

> 結論：**AI 不可自批，L11 不批准也不下單**。任何將「AI 自行批准」或「L11 作為批准/下單層」之表述，均屬錯誤語義，必須以本段落取代以避免新舊混讀。

- 允許未入 DOCUMENT_INDEX 之文件作為工程/討論參考（非裁決依據；不得凌駕上位裁決序位 DOCUMENT_INDEX、MASTER_ARCH、AI_GOV 與本檔正文）
- 允許依治理狀態與模式（Research/Backtest/Simulation/Paper/Live）在不影響可追溯性之下調整審計密度（但不得刪除關鍵裁決與風控留痕）
---
## 稽核區塊（Audit Section｜非正文）

### 1) 變更清單（Changelog）
- 2026-01-13：L11_LAYER_QA_FIX（收斂 L11 之層級語義為『全層稽核回放與系統維運（非授權／非下單）』；明確交易執行為非 Layer 模組（EXECUTION_CONTROL）且僅能在 L10 授權後運作；補強 L11 最小 I/O 契約（refs）與 Replay Verification 錨定（VERSION_AUDIT/ARCH_FLOW）；修正 Canonical Boundary Declaration 避免 L9/L11 越權混讀；重算 BODY_SHA256。）
- 2026-01-13：L10_LAYER_QA_FIX（補強 L10 最低可機器化 Inputs/Outputs 契約；新增 HumanDecisionRecord_v1、AuthorizationEnvelope_v1；補齊 decision_signature ↔ human_approve_signature Canonical 對齊；明確 L10 與 Gate/Risk/Execution 硬切割；維持 Canonical 主幹語義不變；重算 BODY_SHA256。）
- FINAL_QA_NORMALIZE：移除正文中可能殘留之標籤式非制度條文行（若存在），確保正文乾淨且避免助記混讀。
- FINAL_QA_NORMALIZE：移除 Legacy Snapshot（若存在），以符合『不得保留 Legacy Snapshot』之正文規則。
- FINAL_QA_NORMALIZE：依 HASH_RULE 重新計算並更新 BODY_SHA256，確保稽核指紋可重現。
- 2026-01-11：FINAL_QA_NORMALIZE（基線日期與版本日期對齊；正文去重收斂並移除標籤化定位字樣；衝突裁決秩序文字化收斂並受上位裁決序位約束；稽核區塊固定為四件套；重算 BODY_SHA256。）
- 2026-01-13：L8_LAYER_QA_FIX（補強 L8 最小提案工件鍵與禁止輸出清單：價格/數量/買賣方向/可執行委託等；維持 Canonical 主幹語義不變；重算 BODY_SHA256。）
- 2026-01-13：L9_LAYER_QA_FIX（補強 L9 Report Artifact Schema 與 L9 Integrity Check Schema；明確 L9 自檢與主 Gate 的責任切割與 return_required_items 對位；維持 Canonical 主幹語義不變；重算 BODY_SHA256。）



### 2) 指紋清單（Hash Manifest）
- HASH_METHOD：SHA-256（UTF-8，LF）
- BODY_SHA256：b964b2cfcb5666c3912f14a9eb5c9a2c84da429e247b5962554989f07b17f47a


### 3) 適用範圍（Scope）
本次覆蓋版修正範圍僅限於 doc_key=MASTER_CANON（正文整編與驗收）：
- 基線日期／版本日期對齊（2026-01-11）
- 正文乾淨化：移除標籤化定位字樣與可造成混讀之流程性表述
- 衝突裁決秩序收斂：以上位裁決序位 DOCUMENT_INDEX、MASTER_ARCH、AI_GOV 為約束，並明確本文件之承接定位
- Canonical Flow（L1–L11）層級語義維持單一口徑（L9=投資報告；L10=人類裁決；L11=全層稽核回放）
- 稽核區塊固定化：僅保留 Changelog／Hash Manifest／Scope／Audit Hand-off
- L8（Strategy & Research）章節：補強最小提案工件鍵（refs）與禁止輸出清單，以對齊 MASTER_ARCH「Strategy ≠ Execution」之硬禁項，避免越權下單化灰區。
- L9（Investment Report）章節：補強報告工件 schema（最小必帶欄位/引用鍵/方案欄位禁制）與 L9 內嵌治理自檢輸出 schema，並與主 Gate 的 return_required_items 對位，避免混讀與落地格式漂移。



### 4) 裁決承接（Audit Hand-off）
- 本檔為 doc_key=MASTER_CANON 之現行唯一可引用正文（Canonical Flow（L1–L11）之唯一正文來源）。
- 上位裁決序位固定：DOCUMENT_INDEX、MASTER_ARCH、AI_GOV；本檔之任何條文不得牴觸該裁決序位。
- 本檔定義之層級語義與不可越權邊界（策略 ≠ 下單；AI ≠ 裁決；Regime 高於策略；Risk/Compliance 可否決）為全系統一致口徑；下位文件若仍有殘留語義衝突，應於其 Final QA 整編時收斂至本檔口徑。
- Canonical 定錨：L9＝投資報告層；L10＝人類裁決與交易決策層（唯一授權入口）；L11＝全層工程稽核回放層（非授權／非下單入口）。
