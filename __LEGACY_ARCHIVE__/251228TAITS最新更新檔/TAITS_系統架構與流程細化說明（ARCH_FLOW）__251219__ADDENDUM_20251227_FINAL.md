# TAITS_ç³»çµ±æ¶æ§‹èˆ‡æµç¨‹ç´°åŒ–èªªæ˜ï¼ˆARCH_FLOWï¼‰__251219
doc_keyï¼šARCH_FLOW  
æ²»ç†ç­‰ç´šï¼šB+ï¼ˆCanonical Flow Specificationï½œæ‰¿æ¥ MASTER_CANON / FULL_ARCHï¼‰  
ç‰ˆæœ¬ç‹€æ…‹ï¼šACTIVE Â· LOCK_CANDIDATEï¼ˆæµç¨‹å±¤ç´°åŒ–ï¼Œå…è¨± Only-Add æ“´å……ï¼‰  
ç‰ˆæœ¬æ—¥æœŸï¼š2025-12-19  
é©ç”¨ç¯„åœï¼šTAITS å…¨ç³»çµ±ï¼ˆResearch / Backtest / Simulation / Paper / Liveï¼‰  
å°é½Šæ¯æ³•ï¼šTAITS_AI_è¡Œç‚ºèˆ‡æ±ºç­–æ²»ç†æœ€çµ‚è¦å‰‡å…¨é›†__251217ï¼ˆA+ï¼‰  
è®Šæ›´åŸå‰‡ï¼š**Only-Addï¼ˆåƒ…å¯æ–°å¢ï¼Œä¸å¯åˆªæ¸›ï¼è¦†å¯«ï¼æ”¹å¯«èªç¾©ï¼‰**  
ä¸Šä½ç´„æŸï¼šMASTER_ARCH / MASTER_CANON / DOCUMENT_INDEX  
å¹³è¡Œåƒç…§ï¼šFULL_ARCH / RISK_COMPLIANCE / EXECUTION_CONTROL / UI_SPEC / VERSION_AUDIT / LOCAL_ENV / DEPLOY_OPS / TWSE_RULES  

---

---

# Addendum 2025-12-27ï½œOnly-Addï¼šB+ï¼ˆbucket=Bï¼‰å°ä½ Ã— æ¶æ§‹è£æ±ºå­—ä¸²åŠ©è¨˜åŒ– Ã— Canonical é‚Šç•Œå¼•ç”¨æ¨¡æ¿ï¼ˆFreeze v1.0ï¼‰

> è£œå……æ€§è³ªï¼šOnly-Addï¼ˆåªå¯æ–°å¢ï¼Œä¸å¯åˆªæ¸›ã€è¦†å¯«ã€å·æ›æ—¢æœ‰èªç¾©ï¼‰  
> é©ç”¨æ–‡ä»¶ï¼šTAITS_ç³»çµ±æ¶æ§‹èˆ‡æµç¨‹ç´°åŒ–èªªæ˜ï¼ˆARCH_FLOWï¼‰__251219.mdï¼ˆdoc_keyï¼šARCH_FLOWï¼‰  
> ç”Ÿæ•ˆç‹€æ…‹ï¼šGOVERNANCE_STATE = Freeze v1.0  
> ä¸Šä½è£æ±ºï¼šIndex Gateï¼ˆDOCUMENT_INDEXï¼‰ï¼‹æ²»ç†ç­‰ç´šè¦†è“‹ï¼ˆA+ > A > B > Cï¼‰ï¼‹è¡çªè£æ±ºç¨‹åºï¼ˆDOCUMENT_INDEX Â§6ï¼‰ï¼‹AI_GOVï¼ˆA+ï¼‰æœ€é«˜ç´„æŸ  
> å£å¾‘å°é½Šï¼š  
> - DOCUMENT_INDEXï½œAddendum 2025-12-27-Bï¼ˆB+/C+ å­ç´šæ¨™ç±¤å®šç¾© Ã— è¦†è“‹è¦å‰‡å°ä½ï¼‰ã€”æª”åï¼šTAITS_æ–‡ä»¶ç´¢å¼•èˆ‡æ²»ç†å°ç…§è¡¨ï¼ˆDOCUMENT_INDEXï¼‰__251220__ADDENDUM_20251227B_FINAL.mdã€•  
> - DOCUMENT_INDEXï½œAddendum 2025-12-27ï¼ˆè£æ±ºé †åºå­—ä¸²çµ±ä¸€ Ã— æ­§ç¾©æ¶ˆè§£ï¼‰  
> - MASTER_CANONï½œAddendum 2025-12-27ï¼ˆS æ¨™ç±¤å®šä½ Ã— è£æ±ºå­—ä¸²æ¶ˆæ­§ï¼‰  
> - GOVERNANCE_GATE_SPECï½œAddendum 2025-12-27ï¼ˆå­—ä¸²åŠ©è¨˜å®šä½ Ã— é›™è»Œè£æ±ºæ¶ˆæ­§ï¼‰  
> ç¨½æ ¸å°ä½ï¼šVERSION_AUDITï½œAppendix Aï½œMETADATA_FIX Ledgerï¼ˆå»ºè­°æ–°å¢æ¢ç›®ï¼š`VA-METADATA_FIX-20251227-0003`ï¼‰  
> ç›®çš„ï¼šåœ¨ä¸æ”¹å¯«æ­£æ–‡çš„å‰æä¸‹ï¼Œä¿®è£œæœ¬æ–‡ä»¶ã€Œæ²»ç†ç­‰ç´š B+ã€èˆ‡ Index è¦†è“‹è¦å‰‡ä¹‹å°ä½æ­§ç¾©ï¼›å°‡æœ¬æ–‡ä»¶å…§éƒ¨å¯èƒ½å‡ºç¾çš„ã€Œè£æ±ºé †åºå­—ä¸²ã€æ˜ç¢ºå®šä½ç‚ºåŠ©è¨˜ï¼ˆMnemonicï¼‰ï¼Œé¿å…è¢«èª¤è®€ç‚ºè¦†è“‹è¦å‰‡ï¼›ä¸¦æä¾›ä¸€è‡´çš„ Canonical é‚Šç•Œå¼•ç”¨æ¨¡æ¿ï¼Œç¢ºä¿ Gate/Audit/UI Trace å¯å›æ”¾ã€‚

---

## 0. é©ç”¨ç¯„åœï¼ˆHard Boundaryï¼‰

æœ¬ Addendum åƒ…è™•ç†ä¸‹åˆ—äº‹é …ï¼Œ**ä¸æ”¹å¯«**æœ¬æ–‡ä»¶çš„æ¶æ§‹æ¨¡çµ„å®šç¾©ã€è³‡æ–™æµã€äº‹ä»¶æµã€åˆ†å±¤è²¬ä»»èˆ‡å·¥ç¨‹è¦æ ¼å…§å®¹ï¼š

1) æ²»ç†ç­‰ç´šæ¨™ç¤º `B+` çš„æ³•å¾‹å®šä½ï¼ˆbucket å°ä½ï¼‰  
2) ã€Œè£æ±ºé †åºå­—ä¸²ã€ä¹‹æ³•å¾‹å®šä½ï¼ˆåŠ©è¨˜ â‰  è¦†è“‹è¦å‰‡ï¼‰  
3) å¼•ç”¨ MASTER_ARCH / MASTER_CANON / DOCUMENT_INDEX / AI_GOV æ™‚çš„æœ€å°åˆè¦å¼•ç”¨æ ¼å¼ï¼ˆå¼•ç”¨æ¨¡æ¿ï¼‰

---

## 1. B+ çš„æ³•å¾‹å®šä½ï¼ˆTag â‰  New Gradeï¼‰

### 1.1 çµ±ä¸€è£æ±ºï¼šB+ ç‚ºé¡¯ç¤ºæ¨™ç±¤ï¼Œå…¶ bucket ä»ç‚º B
æœ¬æ–‡ä»¶æª”é ­æˆ–æ­£æ–‡è‹¥å‡ºç¾ã€Œæ²»ç†ç­‰ç´šï¼šB+ã€ï¼Œå…¶å”¯ä¸€åˆæ³•è§£è®€ç‚ºï¼š

- `B+` ç‚º **B é¡æ–‡ä»¶å…§éƒ¨çš„å­ç´šæ¨™ç±¤ï¼ˆsub-grade tagï¼‰**  
- **è£æ±º bucket = B**ï¼ˆä»å— A+ / A è¦†è“‹ï¼›ä»è¦†è“‹ Cï¼‰  
- `+` **ä¸**æ§‹æˆæ–°çš„æ²»ç†ç­‰ç´šå±¤ç´šï¼Œä¸æ”¹å¯«è¦†è“‹è¦å‰‡ï¼ˆA+ > A > B > Cï¼‰

> å…¼å®¹è™•ç†ï¼ˆä¸æ”¹åŸæ–‡ï¼‰ï¼šæ—¢æœ‰ã€ŒB+ã€å­—æ¨£ä¿ç•™ä½œé¡¯ç¤ºæ¨™ç±¤ï¼›å…¶è¦†è“‹/è£æ±ºæ•ˆåŠ›ç”±æœ¬ç¯€å›ºå®šå›æ­¸ bucket=Bã€‚

---

## 2. æ¶æ§‹æ–‡ä»¶çš„è£æ±ºé‚Šç•Œï¼ˆScope Lockï¼‰

### 2.1 æœ¬æ–‡ä»¶çš„è£æ±ºé‚Šç•Œï¼ˆåƒ…é™æ¶æ§‹/æµç¨‹ç´°åŒ–ï¼‰
ARCH_FLOW çš„è£æ±ºåŠ›åƒ…é™æ–¼ï¼š
- ç³»çµ±æ¶æ§‹æ¨¡çµ„åˆ†å·¥èˆ‡é‚Šç•Œ  
- Canonical Flowï¼ˆL1â€“L11ï¼‰åœ¨å·¥ç¨‹å¯¦ä½œä¸­çš„ã€Œè½åœ°æµç¨‹ç´°åŒ–ã€ï¼ˆä¸å¾—æ”¹å¯« Canonical Flow æœ¬èº«ï¼‰  
- äº‹ä»¶æµï¼è³‡æ–™æµï¼ä»‹é¢è²¬ä»»çš„å·¥ç¨‹è¦æ ¼åŒ–æè¿°

ARCH_FLOW **ä¸å¾—**ï¼š
- å–ä»£ DOCUMENT_INDEX çš„æ–‡ä»¶åˆæ³•æ€§è£æ±ºï¼ˆdoc_key / ACTIVE / ç­‰ç´šï¼‰  
- å–ä»£ MASTER_ARCH çš„æ¯æ†²æ³•éµå¾‹  
- å–ä»£ AI_GOVï¼ˆA+ï¼‰å° AI è¡Œç‚º/è¶Šæ¬Šçš„æœ€é«˜ç´„æŸ  
- ä»¥ä»»ä½•ã€Œæ’åºå­—ä¸²ã€æ”¹å¯«è¦†è“‹è¦å‰‡

---

## 3. è£æ±ºé †åºå­—ä¸²çš„æ³•å¾‹å®šä½ï¼ˆMnemonic â‰  Override Ruleï¼‰

å‡¡æœ¬æ–‡ä»¶å…§å‡ºç¾ä¹‹ã€Œè£æ±ºé †åºå­—ä¸²ã€æˆ–ã€Œé«˜â†’ä½é †ä½ã€æè¿°ï¼ˆä¾‹å¦‚ï¼š`DOCUMENT_INDEX â†’ MASTER_ARCH â†’ MASTER_CANON` ä¹‹é¡ç®­é ­åºåˆ—ï¼‰ï¼š

- ä¸€å¾‹è¦–ç‚º **é–±è®€/æ“ä½œåŠ©è¨˜ï¼ˆMnemonicï¼‰**  
- **ä¸å¾—**è¢«ç”¨ä½œè¦†è“‹è¦å‰‡æˆ–è£æ±ºæ¬Šé‡æ–°åˆ†é…  
- è‹¥å…¶è¡¨è¿°èˆ‡ DOCUMENT_INDEX Â§3ï¼ˆè¦†è“‹è¦å‰‡ï¼‰æˆ– Â§6ï¼ˆè¡çªè£æ±ºç¨‹åºï¼‰ç”¢ç”Ÿå¼µåŠ›ï¼š  
  **ä¸€å¾‹å›åˆ° DOCUMENT_INDEX**ï¼ˆä¸å¯è·³æ­¥ï¼‰

---

## 4. Canonical é‚Šç•Œå¼•ç”¨æ¨¡æ¿ï¼ˆGate-Friendly Referenceï¼‰

> ç”¨é€”ï¼šç¢ºä¿ ARCH_FLOW åœ¨å¼•ç”¨ä¸Šä½æ–‡ä»¶æ™‚ï¼Œå¼•ç”¨ç«¯å¯è¢« Gate/Audit æ©Ÿå™¨åŒ–æª¢æ ¸ï¼Œé¿å…å› æ ¼å¼å·®ç•°é€ æˆæ­§ç¾©ã€‚

### 4.1 å¼•ç”¨ DOCUMENT_INDEXï¼ˆåˆæ³•æ€§/ç­‰ç´š/ACTIVEï¼‰
```text
ref_doc_key = DOCUMENT_INDEX
ref_purpose = index_gate_and_override_rule
ref_section = <ä¾‹å¦‚ï¼šÂ§3 / Â§6 / Â§7 / Â§9 / Addendum 2025-12-27-B>
ref_notes = B+/C+ ç‚ºå­ç´šæ¨™ç±¤ï¼›è¦†è“‹è¦å‰‡ä»ç‚º A+ > A > B > C
```

### 4.2 å¼•ç”¨ MASTER_ARCHï¼ˆæ¯æ†²æ³•éµå¾‹ï¼‰
```text
ref_doc_key = MASTER_ARCH
ref_purpose = constitutional_constraints
ref_section = <ä¾‹å¦‚ï¼šä¸»æ¬Š/é‚Šç•Œ/å¦æ±ºæ¬Šæ®µè½>
```

### 4.3 å¼•ç”¨ MASTER_CANONï¼ˆæµç¨‹èªç¾©/å±¤ç´šé‚Šç•Œï¼‰
```text
ref_doc_key = MASTER_CANON
ref_purpose = canonical_flow_semantics
ref_gov_grade = A            # ä»¥ DOCUMENT_INDEX è£æ±ºç‚ºæº–ï¼›S åƒ…ç‚ºæ•˜äº‹/ç‰ˆæœ¬æ¨™ç±¤
ref_section = <ä¾‹å¦‚ï¼šL1â€“L11 å°ä½æ®µè½/Â§15 è¡çªè£æ±ºç§©åº>
```

### 4.4 å¼•ç”¨ AI_GOVï¼ˆAI è¡Œç‚º/è¶Šæ¬Šæœ€é«˜ç´„æŸï¼‰
```text
ref_doc_key = AI_GOV
ref_purpose = ai_behavior_and_decision_boundary
ref_section = <AI è¶Šæ¬Š/ä¸å¯è£œå®Œ/ä¸å¯æ”¹åˆ¶åº¦ä¹‹æ¢æ¬¾>
```

---

## 5. æœ€çµ‚å®£å‘Šï¼ˆFreeze v1.0ï¼‰

- æœ¬ Addendum ç‚º Only-Addï¼›ä¸æ”¹å¯«ä»»ä½•æ—¢æœ‰æ­£æ–‡ã€‚  
- `B+` åœ¨æœ¬æ–‡ä»¶ä¸­åƒ…ç‚ºé¡¯ç¤ºæ¨™ç±¤ï¼›è£æ±º bucket å›ºå®šç‚º Bã€‚  
- æ‰€æœ‰è¡çªè£æ±ºä»å¿…é ˆå›åˆ° DOCUMENT_INDEX ä¹‹è¦†è“‹è¦å‰‡èˆ‡ç¨‹åºï¼ˆÂ§3ï¼Â§6ï¼‰ã€‚  
- è‹¥ç¼ºå°‘å¿…è¦å¼•ç”¨è³‡è¨Šï¼ˆdoc_key / section / versionï¼‰ï¼Œåƒ…å…è¨±åˆ—ç¼ºå£ï¼Œä¸å…è¨±è£æ±ºæ€§è¼¸å‡ºã€‚

ï¼ˆAddendum 2025-12-27ï½œOnly-Addï½œFreeze v1.0 å®Œï¼‰


## 0. æ–‡ä»¶å®šä½ï¼ˆArchitecture Flow Specificationï½œä¸å¯çœç•¥ï¼‰

æœ¬æ–‡ä»¶ç‚º **TAITS Canonical Flowï¼ˆL1â€“L11ï¼‰ä¹‹ã€Œæœ€å¤§å®Œå‚™æµç¨‹æ³•è¦ã€**ï¼Œ  
ä»¥åˆ¶åº¦åŒ–æ–¹å¼å®šç¾©ï¼š

1) **æµç¨‹è§¸ç™¼ï¼ˆTriggerï¼‰**  
2) **å„å±¤è²¬ä»»é‚Šç•Œï¼ˆåšä»€éº¼ï¼ä¸åšä»€éº¼ï¼‰**  
3) **ä¸­æ–·ã€é€€å›ã€å¦æ±ºèˆ‡ç·Šæ€¥ä¸­æ­¢çš„æ³•å®šèªç¾©**  
4) **è·¨é‹è¡Œæ¨¡å¼çš„ä¸€è‡´æ€§ï¼ˆResearch / Backtest / Simulation / Paper / Liveï¼‰**  
5) **å¯©è¨ˆã€å›æ”¾ã€ç‰ˆæœ¬ä¸€è‡´æ€§ä¹‹æœ€ä½ä¸å¯é™æ¨™æº–**

ğŸ“Œ åš´æ ¼éµå®ˆï¼š
- **L1â€“L11 ä¸å¯è·³æ­¥**
- **æµç¨‹ â‰  ç­–ç•¥ï¼›æµç¨‹ â‰  ä¸‹å–®**
- **ä»»ä½•ä¸­æ–·å¿…é ˆå¯è§£é‡‹ã€å¯å›æ”¾**
- **Risk / Compliance å…·æœ€é«˜å¦æ±ºæ¬Š**
- **Human-in-the-Loop ä¸å¯è¢«æ›¿ä»£**

---

## 1. Canonical Flow çš„ä¸è®Šæ ¸å¿ƒï¼ˆäº”å¤§æµç¨‹å…¬ç†ï¼‰

1. **å–®å‘æ€§ï¼ˆForward-onlyï¼‰**  
   åªèƒ½å‰é€²æˆ–ä¸­æ–·ï¼›ä¸å­˜åœ¨éš±æ€§å›å¯«æˆ–å·å·ä¿®æ­£ã€‚

2. **å±¤ç´šéš”é›¢ï¼ˆLayer Isolationï¼‰**  
   æ¯å±¤åªè™•ç†è©²å±¤è²¬ä»»ï¼›ä»»ä½•è¶Šæ¬Šå³é•è¦ã€‚

3. **è­‰æ“šå…ˆæ–¼åˆ¤æ–·ï¼ˆEvidence Firstï¼‰**  
   ç„¡ Evidence ä¸å¾—é€²å…¥ Regime / Risk / Strategyã€‚

4. **å¦æ±ºå„ªå…ˆæ–¼å»ºè­°ï¼ˆVeto > Proposalï¼‰**  
   ä»»ä¸€å¦æ±ºç«‹å³ç”Ÿæ•ˆï¼›ç¸¾æ•ˆä¸å¾—è¾¯è­·ã€‚

5. **äººé¡è£æ±ºä¸å¯è¢«æ¨¡æ“¬**  
   L10 åƒ…ç”±äººé¡å®Œæˆï¼›AI ä¸å¾—å–å¾—æœ€çµ‚è£æ±ºæ¬Šã€‚

---

## 2. Canonical Flow ç¸½è¦½ï¼ˆL1â€“L11ï½œä¸å¯è·³æ­¥ï¼‰

```text
L1  Data Ingestionï¼ˆè³‡æ–™å–å¾—ï¼‰
L2  Validation & Normalizationï¼ˆæ ¡é©—/æ­£è¦åŒ–ï¼‰
L3  Snapshot & State Buildï¼ˆå¿«ç…§/ç‹€æ…‹å»ºæ§‹ï¼‰
L4  Feature / Indicator / Structure Extractionï¼ˆç‰¹å¾µ/æŒ‡æ¨™/çµæ§‹ï¼‰
L5  Evidence Bundle Assemblyï¼ˆè­‰æ“šåŒ…ï¼‰
L6  Regime Determinationï¼ˆå¸‚å ´ç‹€æ…‹ï¼‰
L7  Risk & Compliance Gateï¼ˆæœ€é«˜å¦æ±ºï¼‰
L8  Strategy Proposal Generationï¼ˆç­–ç•¥å»ºè­°ï¼‰
L9  Governance Gateï¼ˆæ²»ç†é–˜é–€ï¼‰
L10 UI Decision & Explainï¼ˆäººæ©Ÿæ±ºç­–/å¯è§£é‡‹ï¼‰
L11 Execution & Controlï¼ˆå—æ§åŸ·è¡Œï¼‰
è·¨å±¤ç¸½ç¦æ­¢ï¼š

å±¤é–“å›å¯«ï¼ˆBack-writeï¼‰

è·³å±¤ï¼ˆSkippingï¼‰

ç­–ç•¥ç›´é€£åŸ·è¡Œ

AI è‡ªä¸»åŒ–

Annotation å‡æ ¼

3. æµç¨‹ç‹€æ…‹è½‰ç§»çŸ©é™£ï¼ˆState Transition Matrixï½œæœ€å¤§å®Œå‚™ï¼‰
Layer	è¼¸å…¥ç‹€æ…‹	æˆåŠŸè¼¸å‡º	å¤±æ•—ç‹€æ…‹	å¤±æ•—å»å‘
L1	NoData	RawDataReady	SourceFail	STOP
L2	RawDataReady	CanonicalReady	QAFail	STOP
L3	CanonicalReady	SnapshotReady	SnapshotFail	STOP
L4	SnapshotReady	FeatureReady	AnalysisFail	STOP
L5	FeatureReady	EvidenceReady	EvidenceInsufficient	RETURN L4
L6	EvidenceReady	RegimeReady	RegimeUnclear	STOP
L7	RegimeReady	RiskPass	RiskVeto	STOP
L8	RiskPass	StrategyReady	NoStrategy	RETURN L6
L9	StrategyReady	FlowValid	FlowInvalid	RETURN L4
L10	FlowValid	HumanApprove	HumanReject	STOP
L11	HumanApprove	Executed	ExecFail	EMERGENCY_STOP

4. ä¸­æ–·é¡å‹ï¼ˆInterrupt Taxonomyï¼‰
4.1 é¡å‹
Hard Stopï¼šRisk Veto / Compliance Violation

Soft Returnï¼šEvidence ä¸è¶³ / Strategy ä¸é©ç”¨ / Flow ä¸å®Œæ•´

Emergency Stopï¼šExecution ç•°å¸¸ / ç³»çµ±éŒ¯èª¤ / äººå·¥ Kill Switch

4.2 æœ€å°å¯©è¨ˆè¦æ±‚
ä»»ä½•ä¸­æ–·å¿…ç•™ï¼š

ä¸­æ–·å±¤ç´šï¼ˆLayerï¼‰

åŸå› ç¢¼ï¼ˆReason Codeï¼‰

Evidence Snapshot

Version Reference

5. å¤šæ¨¡å¼ä¸€è‡´æ€§ï¼ˆMode Consistencyï¼‰
å…è¨±è®Šå‹•ï¼š

è³‡æ–™ä¾†æºï¼ˆæ­·å²/å³æ™‚ï¼‰

æ™‚é–“æ¨é€²ï¼ˆæ¨¡æ“¬/çœŸå¯¦ï¼‰

Execution é–‹é—œï¼ˆçœŸå¯¦/æ¨¡æ“¬ï¼‰

ç¦æ­¢è®Šå‹•ï¼š

L1â€“L11 é †åº

Risk / Governance Gate

Human Decision å­˜åœ¨æ€§

å¯©è¨ˆå¯†åº¦

6. å…¨åŸŸ Hard Gatesï¼ˆæ‘˜è¦ï¼‰
Gate	è§¸ç™¼	è™•ç½®
Human Sovereignty	ç„¡äººå€¼å®ˆ	BLOCK
Evidence Replay	ä¸å¯å›æ”¾	BLOCK
Regime Precondition	ä¸ç¬¦/è¡çª	DOWNGRADE / BLOCK
Risk Veto	ä»»ä¸€ç–‘æ…®	VETO
Strategyâ‰ Execution	å«æ–¹å‘/ä¸‹å–®	BLOCK
Governance Completeness	ç¼ºå¯©è¨ˆ	RETURN

7. L1â€“L11 é€å±¤æ³•è¦ï¼ˆç²¾è¦ï¼‰
L1ï½œData Ingestion
è¼¸å‡ºï¼šraw_snapshot_id / source_provenance
ç¦æ­¢ï¼šæ¨è«–ã€æ¸…æ´—ã€æ–¹å‘åŒ–
å¤±æ•—ï¼šABORT(L1_FETCH_FAIL)

L2ï½œValidation & Normalization
è¼¸å‡ºï¼švalidated_snapshot_id / validation_report
ç¦æ­¢ï¼šä»¥ä¼°ç®—æ©è“‹ç¼ºå£
å¤±æ•—ï¼šABORT(L2_SCHEMA_FAIL)

L3ï½œSnapshot & State
è¼¸å‡ºï¼šmarket_snapshot / replay_anchor
ç¦æ­¢ï¼šåªå­˜åœ¨è¨˜æ†¶é«”
å¤±æ•—ï¼šABORT(L3_STATE_INTEGRITY_FAIL)

L4ï½œFeature / Structure
è¼¸å‡ºï¼šfeature_vector / structure_state
ç¦æ­¢ï¼šæ–¹å‘åŒ– / éç™½åå–® Feature / Annotation å‡æ ¼
å¤±æ•—ï¼šABORT(L4_ILLEGAL_FEATURE)

L5ï½œEvidence Bundle
è¼¸å‡ºï¼ševidence_bundle_id / completeness_score
ç¦æ­¢ï¼šä»¥æ¨æ¸¬è£œè­‰æ“š
å¤±æ•—ï¼šRETURN æˆ– ABORT(L5_EVIDENCE_INCOMPLETE)

L6ï½œRegime
è¼¸å‡ºï¼šregime_state / confidence / conflict_flag
ç¦æ­¢ï¼šç”±ç­–ç•¥åæ¨
å¤±æ•—ï¼šABORT(L6_REGIME_UNDEFINED)

L7ï½œRisk & Compliance
è¼¸å‡ºï¼šPASS / VETO / DOWNGRADE / AVOID + reason codes
ç¦æ­¢ï¼šç¸¾æ•ˆè¾¯è­·
å¤±æ•—ï¼šVETOï¼ˆæœ€é«˜ï¼‰

L8ï½œStrategy Proposal
è¼¸å‡ºï¼šproposalï¼ˆéæ–¹å‘ï¼‰
ç¦æ­¢ï¼šåƒ¹æ ¼/æ•¸é‡/ä¸‹å–®
å¤±æ•—ï¼šABORT(L8_OUTPUT_VIOLATION)

L9ï½œGovernance Gate
è¼¸å‡ºï¼šPASS / RETURN / BLOCK
ç¦æ­¢ï¼šæ”¾è¡Œç¼ºè­‰æ“š
å¤±æ•—ï¼šRETURN æˆ– BLOCK

L10ï½œUI Decision
è¼¸å‡ºï¼šdecision_trace / risk_disclosure
ç¦æ­¢ï¼šèª˜å°ä¸‹å–® / éš±è—å¦æ±º
å¤±æ•—ï¼šSTOP

L11ï½œExecution & Control
è¼¸å‡ºï¼šexecution_log / kill_switch_state
ç¦æ­¢ï¼šç„¡äººå€¼å®ˆ
å¤±æ•—ï¼šEMERGENCY_STOP

8. å¯©è¨ˆï¼ˆAuditï¼‰ç¸½å‰‡ï½œã€Œç„¡ç´€éŒ„ï¼æœªç™¼ç”Ÿã€
è¦†è“‹ L1â€“L11ã€æ‰€æœ‰ä¸­æ–·ã€æ‰€æœ‰æ¨¡å¼

ä¸å¾—ä»¥ Console Log å–ä»£æ­£å¼å¯©è¨ˆç‰©

8.1 Mandatory Audit Fieldsï¼ˆæœ€å°é›†ï¼‰
correlation_id / session_id / layer_id / module_id

timestamp_utc / version_ref

input_hash / output_hash / status / reason_codes

8.2 å±¤ç´šå°ˆå±¬
L3ï¼šsnapshot_id

L5ï¼ševidence_id / provenance_map

L6ï¼šregime_label / confidence

L7ï¼špolicy_version / veto_reason_codes

L10ï¼šuser_id / ui_trace

L11ï¼šorder_id_map / kill_switch_events

9. å›æ”¾ï¼ˆReplayï¼‰è¦ç¯„
Replay Bundleï¼ˆæœ€å°é›†åˆï¼‰ï¼š

documents_active_map

evidence_bundle

regime_state

risk_decision

human_decisionï¼ˆè‹¥æœ‰ï¼‰

execution_logsï¼ˆè‹¥æœ‰ï¼‰

all_hashes

ä¸€è‡´æ€§è¦æ±‚ï¼š ç›¸åŒ Bundle â†’ ç›¸åŒçµè«–ï¼›å¦å‰‡è¦–ç‚ºæ±¡æŸ“ã€‚

10. ç‰ˆæœ¬ä¸€è‡´æ€§ï¼ˆVersion Alignmentï¼‰
æ‰€æœ‰è¼¸å‡ºå¿…ç¶ version_ref

æ–°ç‰ˆä¸å¾—ç ´å£èˆŠ Replay

èˆ‡ VERSION_AUDIT åˆ†å·¥ï¼š

ARCH_FLOW å®šç¾©ã€Œåœ¨å“ªè£¡å¼•ç”¨ç‰ˆæœ¬ã€

VERSION_AUDIT ç®¡ç†ã€Œå¦‚ä½•è¿½æº¯/å›é€€ã€

11. Mermaidï¼ˆå«é€€å›/å¦æ±ºï¼‰
mermaid
è¤‡è£½ç¨‹å¼ç¢¼
flowchart TB
  L1[L1 Data] --> L2[L2 QA]
  L2 --> L3[L3 Snapshot]
  L3 --> L4[L4 Analysis]
  L4 --> L5[L5 Evidence]
  L5 -->|OK| L6[L6 Regime]
  L5 -->|Insufficient| L4
  L6 -->|OK| L7[L7 Risk]
  L6 -->|Unclear| STOP1[STOP]
  L7 -->|PASS| L8[L8 Strategy]
  L7 -->|VETO| STOP2[STOP]
  L8 -->|OK| L9[L9 Governance]
  L8 -->|None| L6
  L9 -->|PASS| L10[L10 Human]
  L9 -->|INVALID| L4
  L10 -->|APPROVE| L11[L11 Exec]
  L10 -->|REJECT| STOP3[STOP]
  L11 -->|SUCCESS| END[END]
  L11 -->|FAIL| EMERGENCY[EMERGENCY STOP]
12. FULL_ARCH å°ä½
FULL_ARCHï¼šå®šç¾©ã€Œæœ‰ä»€éº¼å±¤/æ¨¡çµ„ã€

ARCH_FLOWï¼šå®šç¾©ã€Œå¦‚ä½•æŒ‰åºé‹ä½œã€

ä»»ä¸€ä¸å°ä½ â†’ éæ³•

13. Only-Add æ¼”é€²è¦å‰‡
å…è¨±ï¼š

æ–°å¢å­æµç¨‹ï¼ˆL4.1ã€L7.2ï¼‰

æ–°å¢ä¸­æ–·åŸå› ç¢¼

æ–°å¢æ¨¡å¼ï¼ˆSandboxï¼‰

ç¦æ­¢ï¼š

åˆªé™¤/åˆä½µ L1â€“L11

æ”¹å¯«ä¸­æ–·èªç¾©

ä»¥æ•ˆèƒ½ç‚ºç”±çœç•¥å¯©è¨ˆ

ï¼ˆARCH_FLOWï½œæœ€å¤§å®Œå‚™æ•´åˆç‰ˆ å®Œï¼‰
Appendix Aï½œARCH_FLOW Ã— MASTER_CANON å·®ç•°èˆ‡å°é½Šè£œå……ï¼ˆOnly-Addï¼‰
ï¼ˆOnly-Add Â· Alignment Addendum Â· Freeze v1.0ï¼‰

A.0 è£œå……æ€§è³ªè²æ˜ï¼ˆä¸å¯çœç•¥ï¼‰
é©ç”¨æ–‡ä»¶ï¼šARCH_FLOWï¼ˆdoc_key=ARCH_FLOWï¼‰

è£œå……é¡å‹ï¼šAddendum / Guidelineï¼ˆå°é½Šè£œå……ï¼›ä¸æ”¹å¯« Canonicalï¼‰

ç”Ÿæ•ˆç‹€æ…‹ï¼šGOVERNANCE_STATE = Freeze v1.0

è®Šæ›´åŸå‰‡ï¼šOnly-Addï¼ˆ0 åˆªæ¸› / 0 è¦†å¯« / 0 å·æ›èªç¾©ï¼‰

è¡çªè£æ±ºï¼šDOCUMENT_INDEX â†’ MASTER_ARCH â†’ MASTER_CANON

A.1 èˆ‡ MASTER_CANON çš„å®šä½å·®ç•°ï¼ˆæ³•æºåˆ†å·¥ï¼‰
MASTER_CANONï¼šè£æ±º L1â€“L11 çš„æ³•å¾‹åœ°ä½ã€è²¬ä»»é‚Šç•Œã€å…¬ç†ï¼ˆå« Human-in-the-Loop ä¸å¯ç§»é™¤ã€Veto é«˜æ–¼ä¸€åˆ‡ã€Evidence First ç­‰ï¼‰

ARCH_FLOWï¼šåœ¨ä¸æ”¹å¯« Canonical çš„å‰æä¸‹ï¼Œåˆ¶åº¦åŒ–å®šç¾©ï¼š

æµç¨‹è§¸ç™¼ã€ç‹€æ…‹è½‰ç§»ã€é€€å›/ä¸­æ­¢èªç¾©

è·¨æ¨¡å¼ä¸€è‡´æ€§

å¯©è¨ˆ/å›æ”¾/ç‰ˆæœ¬ä¸€è‡´æ€§ä¹‹æœ€ä½ä¸å¯é™æ¨™æº–

å› æ­¤ï¼š

ARCH_FLOW å¯ã€Œç´°åŒ–æµç¨‹ç¯€é»ã€

ä½†ä¸å¾—ã€Œæ–°å¢å±¤ç´šã€æ”¹å¯«å±¤ç´šèªç¾©ã€æä¾› Canonical çš„æ›¿ä»£å®šç¾©ã€

A.2 Canonical Flowï¼ˆL1â€“L11ï¼‰ä¸å¯è®Šï¼šARCH_FLOW çš„åˆæ³•ç´°åŒ–ç¯„åœ
ARCH_FLOW çš„ç´°åŒ–åªå…è¨±ç™¼ç”Ÿåœ¨ï¼š

æ—¢æœ‰ Layer å…§éƒ¨ï¼ˆä¾‹å¦‚ï¼šL4.1 / L7.2 ç­‰å­æµç¨‹ï¼‰

ä»¥ã€Œæª¢æŸ¥é»ï¼ˆchecksï¼‰ã€ã€Œå¿…å‚™ç”¢ç‰©ï¼ˆartifactsï¼‰ã€ã€Œç‹€æ…‹è½‰ç§»ï¼ˆstate transitionsï¼‰ã€å‘ˆç¾

ARCH_FLOW ä¸å…è¨±ï¼š

ä»¥å·¥ç¨‹æ–¹ä¾¿ç‚ºç”±èª¿æ›é †åºæˆ–åˆä½µ Layer

ä»¥æ•ˆç‡ç‚ºç”±çœç•¥ Evidence / Audit / Replay

A.3 å°é½Š MASTER_CANONã€ŒL10 äººé¡è£æ±ºã€çš„æœ€å°ä¸€è‡´æ€§ï¼ˆOnly-Addï¼‰
ç‚ºå°é½Š MASTER_CANON çš„ L10 æ³•æºè¦æ±‚ï¼ŒARCH_FLOW çš„ L10ã€Œè¼¸å‡ºã€èˆ‡ã€Œç¦æ­¢äº‹é …ã€å¿…é ˆè¢«è¦–ç‚ºï¼š

UI_SPEC çš„ç¡¬è¦æ ¼å‰ç½®æ¢ä»¶ï¼ˆDecision Trace / Risk Disclosure å¿…é ˆå¯å›æ”¾ï¼‰

ä»»ä½•ä¸ç”Ÿæˆ decision_trace æˆ–ç­‰åƒ¹å¼•ç”¨è€…ï¼Œä¸€å¾‹è¦–ç‚º æµç¨‹ä¸å®Œæ•´ï¼ˆæ‡‰è½æ–¼ L9 Governance Gate çš„ FlowInvalid/RETURNï¼‰

æœ¬æ¢ç‚ºå°é½Šè£œå¼·ï¼Œä¸æ”¹å¯«ä½ åŸæ–‡ç¬¬ 7 ç¯€ L10 è¦æ ¼ã€‚

A.4 å°é½Š MASTER_CANON é™„éŒ„ Zï¼ˆL9a / L10 / L11ï¼‰ä¹‹éæ··ç”¨åŸå‰‡ï¼ˆOnly-Addï¼‰
è‹¥ç³»çµ±/æ–‡ä»¶/å ±å‘Šå­˜åœ¨ã€ŒL9a äººè©±æ•˜äº‹ï¼ˆåˆ†æå¸«æ•˜äº‹ï¼‰ã€ä¹‹è¼¸å‡ºï¼š

å¿…é ˆè¢«æ¨™è¨˜ç‚ºï¼šNON_DECISION_REFERENCEï¼ˆéè£æ±ºåƒè€ƒï¼‰

ä¸å¾—ç›´æ¥å½±éŸ¿ï¼š

State Transition Matrix

Risk Gateï¼ˆL7ï¼‰è£æ±º

Human Decisionï¼ˆL10ï¼‰æŒ‰éˆ•å¯ç”¨æ€§

å…¶å”¯ä¸€åˆæ³•ä½ç½®ï¼š

ä½œç‚º L10 çš„åƒè€ƒè³‡æ–™ï¼ˆReferenceï¼‰ï¼Œä¸”å¿…é ˆå¯å›æŒ‡ Evidence refsï¼ˆä¸å¾—åƒ…æ–‡å­—ï¼‰

æœ¬æ¢åªç‚ºã€Œé˜²æ­¢æ··ç”¨ã€ï¼Œä¸æ–°å¢å±¤ç´šã€ä¸æ”¹å¯« Canonicalã€‚

Appendix Bï½œæ¸²æŸ“å®‰å…¨ç‰ˆ Mermaidï¼ˆOnly-Addï¼Œä¸è¦†å¯«åŸæ–‡ï¼‰
ï¼ˆOnly-Add Â· Rendering-Safe Copy Â· Freeze v1.0ï¼‰

B.0 è£œå……æ€§è³ªè²æ˜
é©ç”¨æ–‡ä»¶ï¼šARCH_FLOW

è£œå……é¡å‹ï¼šAppendixï¼ˆæ¸²æŸ“ä¿®å¾©å‰¯æœ¬ï¼›åŸæ–‡ä¿ç•™ï¼‰

èªªæ˜ï¼šåŸç¬¬ 11 ç¯€ Mermaid å€å¡Šåœ¨ md ä¸­å±¬ã€Œéæ¨™æº– fenced codeã€æ ¼å¼ï¼›æœ¬é™„éŒ„æä¾›ç­‰åƒ¹å¯æ¸²æŸ“å‰¯æœ¬ï¼Œç”¨æ–¼å·¥ç¨‹æ–‡ä»¶èˆ‡ UI/README å¼•ç”¨ï¼Œä¸æ›¿ä»£ã€ä¸è¦†å¯«åŸæ–‡ã€‚

B.1 Canonical Flowï¼ˆå«é€€å›/å¦æ±ºï¼‰â€” æ¸²æŸ“å®‰å…¨ç‰ˆ
mermaid
è¤‡è£½ç¨‹å¼ç¢¼
flowchart TB
  L1[L1 Data] --> L2[L2 QA]
  L2 --> L3[L3 Snapshot]
  L3 --> L4[L4 Analysis]
  L4 --> L5[L5 Evidence]

  L5 -->|OK| L6[L6 Regime]
  L5 -->|Insufficient| L4

  L6 -->|OK| L7[L7 Risk]
  L6 -->|Unclear| STOP1[STOP]

  L7 -->|PASS| L8[L8 Strategy]
  L7 -->|VETO| STOP2[STOP]

  L8 -->|OK| L9[L9 Governance]
  L8 -->|None| L6

  L9 -->|PASS| L10[L10 Human]
  L9 -->|INVALID| L4

  L10 -->|APPROVE| L11[L11 Exec]
  L10 -->|REJECT| STOP3[STOP]

  L11 -->|SUCCESS| END[END]
  L11 -->|FAIL| EMERGENCY[EMERGENCY STOP]
Appendix Cï½œReason Code / Artifact / Replay æœ€å°é›†å°é½Šè£œå¼·ï¼ˆOnly-Addï¼‰
ï¼ˆOnly-Add Â· Audit/Replay Hardening Â· Freeze v1.0ï¼‰

C.0 è£œå……æ€§è³ªè²æ˜
é©ç”¨æ–‡ä»¶ï¼šARCH_FLOW

è£œå……é¡å‹ï¼šGuidelineï¼ˆæœ€å°é›†è£œå¼·ï¼›ä¸æ–°å¢åˆ¶åº¦è£æ±ºæ¬Šï¼‰

ç›®çš„ï¼šä½¿ã€Œä¸­æ–·å¿…ç•™åŸå› ç¢¼ / Evidence Snapshot / Version Referenceã€å¯è¢«å·¥ç¨‹è½åœ°ç‚ºä¸€è‡´çš„æœ€å°é›†åˆï¼Œä¸¦èˆ‡ VERSION_AUDIT / UI_SPEC / EXECUTION_CONTROL çš„å¼•ç”¨æ–¹å¼ä¸è¡çªã€‚

C.1 ä¸­æ–·äº‹ä»¶æœ€å°æ¬„ä½é›†ï¼ˆInterrupt Event Minimal Fieldsï¼‰
å‡¡å±¬ STOP / RETURN / VETO / EMERGENCY_STOP äº‹ä»¶ï¼Œè‡³å°‘å¿…é ˆç”¢ç”Ÿï¼š

correlation_id

layer_id

statusï¼šSTOP / RETURN / VETO / EMERGENCY_STOP

reason_codes[]

evidence_snapshot_refï¼ˆè‹¥é©ç”¨ï¼›è‡³å°‘å°æ‡‰ L5 evidence_bundle_id æˆ–ç­‰åƒ¹å¼•ç”¨ï¼‰

version_refï¼ˆdocuments_active_map æˆ– active_versions çš„å¼•ç”¨ï¼‰

timestamp_utc

output_hashï¼ˆæˆ–ç­‰åƒ¹ä¸å¯å¦èªæ‘˜è¦ï¼‰

æœ¬æ¢ä¸æ”¹å¯«ä½ åŸæ–‡ç¬¬ 4.2 èˆ‡ç¬¬ 8.1ï¼Œåªæ˜¯æŠŠã€Œå¿…ç•™ã€å…·é«”åŒ–ç‚ºå¯è½åœ°æ¬„ä½é›†ã€‚

C.2 Replay Bundle æœ€å°é›†åˆï¼ˆèˆ‡åŸæ–‡ç¬¬ 9 ç¯€ä¸€è‡´ï¼‰
Replay Bundle ä»ä»¥åŸæ–‡ç‚ºæº–ï¼Œä¸¦è£œå¼·ä¸€æ¢ä¸€è‡´æ€§æª¢æŸ¥ï¼š

Replay Loader å¿…é ˆæª¢æŸ¥ documents_active_map èˆ‡ version_ref ä¸€è‡´ï¼›ä»»ä¸€ç¼ºæ¼ â†’ è¦–ç‚º Replay ä¸æˆç«‹ï¼ˆæ‡‰ BLOCK/STOPï¼‰

C.3 ç‰ˆæœ¬ä¸€è‡´æ€§ï¼šARCH_FLOW èˆ‡ VERSION_AUDIT çš„å¼•ç”¨é‚Šç•Œï¼ˆOnly-Addï¼‰
ARCH_FLOWï¼šå®šç¾©ã€Œæ¯å€‹å±¤åœ¨å“ªè£¡å¿…é ˆå¼•ç”¨ version_refã€

VERSION_AUDITï¼šç®¡ç†ã€Œç‰ˆæœ¬å¦‚ä½•è¿½æº¯ã€å›é€€ã€è®Šæ›´å¸³æœ¬ã€
æœ¬æ¢åƒ…é‡ç”³ä½ åŸæ–‡ç¬¬ 10 ç¯€åˆ†å·¥ï¼Œä¸¦æ˜ç¢ºç¦æ­¢ä»¥ã€Œå£é ­/å°è©±ã€æ›¿ä»£ç‰ˆæœ¬å¼•ç”¨ã€‚

ï¼ˆARCH_FLOWï½œOnly-Add æœ€å¤§å®Œå‚™è£œå¼·ï¼šAppendix Aâ€“C Â· Freeze v1.0ï¼‰
