# TAITS_最新細節規格彙編__251217.md

> doc_key：DETAIL_CANON_COMPENDIUM  
> 規格等級：A（跨層細節｜補強 Canon）  
> 適用範圍：TAITS 全系統  
> 狀態：ACTIVE（Canonical｜Only-Add）

---

## 0. 文件定位（為什麼需要這份）

本文件用來集中 **不適合分散在架構、流程、策略文件中的「關鍵細節規範」**，  
確保：

- 重要細節不被遺忘
- 未來擴充不必反覆修改多份文件
- AI 與人類對「細節怎麼處理」有一致理解

📌 本文件 **補強但不推翻** 任何上位 Canon。

---

## 1. 官方制度引用原則（Mandatory）

### 1.1 核心原則

- 交易制度、撮合規則、交易時間、限制條件  
  **一律以官方來源為準**
- TAITS 文件：
  - 描述「制度存在」
  - 描述「制度如何被系統引用」
  - **不寫死數值與時間**

### 1.2 官方來源（當前）

- 台灣證券交易所（TWSE）官方網站  
- 櫃買中心（TPEX）官方網站  
- 券商官方 API 文件（富邦 TradeAPI）

📌 若官方制度變更，  
只需更新引用連結，不需重寫系統文件。

---

## 2. 零股（Odd-Lot）交易特性彙編（當前核心）

### 2.1 為何零股是預設

- 預算有限
- 流動性差異大
- 成交不確定性高
- 更適合風控導向設計

### 2.2 零股的系統含意

Execution 必須容忍：
- 延遲成交
- 部分成交
- 完全未成交
- 多次失敗後中止

Risk 必須考慮：
- 流動性風險
- 滑價不可預期
- 無法自動升級交易單位

Strategy 必須：
- 不假設立即成交
- 不依賴精準價格

---

## 3. 交易單位升級的治理語義（重申）

- odd_lot：唯一預設啟用
- full_lot：制度預留，未啟用
- hybrid：Execution 編排預留，未啟用

📌 **任何升級都必須是「明確治理決策」，而非系統自動行為。**

---

## 4. Execution 與券商 API 適配原則

### 4.1 券商定位

- 當前唯一主要設計對象：**富邦 TradeAPI**
- Execution 層需設計 Adapter
- 不得將券商 API 行為寫死進 Strategy

### 4.2 API 失敗處理

- API 失敗 → 停止流程
- 記錄錯誤
- 不自動重試實盤下單

---

## 5. Log / Audit / Replay 細節規格

### 5.1 必備 Log 類型（重申）

- Data Ingestion Log
- Strategy Decision Log
- Risk Decision Log
- Execution Log

### 5.2 Correlation ID

- 每一個 Intent / 委託 / 裁決  
  必須有 correlation_id
- 用於完整因果鏈追蹤

### 5.3 可回放要求

- Log 必須可用於：
  - 重建當時狀態
  - 解釋為何做出該決策
- 無 Log 視同未發生

---

## 6. 人類操作與介入備註

### 6.1 人類角色

- 人類為最終裁決者
- 可隨時：
  - approve
  - veto
  - pause
  - resume
  - freeze

### 6.2 AI 的限制

- AI 不得自動解除否決
- AI 不得自動升級交易單位
- AI 不得假設人類一定同意

---

## 7. 本地執行與運算環境（備註）

### 7.1 定位

- 本地環境屬於「執行與治理的一部分」
- 目標：
  - 可重現
  - 可審計
  - 可控

### 7.2 原則

- 環境變更需記錄
- 金鑰不得進 repo
- 舊環境紀錄可保留備註

---

## 8. 未來擴充的正確方式（指引）

- 新交易產品 → 新治理文件
- 新交易單位 → 新 Execution 規範
- 新市場 → 新 Scope Canon

📌 **不得直接修改現有 Canon 來塞新功能。**

---

## 9. 細節規格最終宣告

> **細節不是零碎資訊，  
而是讓系統「不會走偏」的護欄。**

---

（End of DETAIL_CANON_COMPENDIUM）
